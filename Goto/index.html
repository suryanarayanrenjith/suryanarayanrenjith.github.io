<!DOCTYPE html>
<html>
<head>
    <title>Redirecting...</title>
    <script>
function isBotOrCurl(userAgentString) {
    return /curl|bot|spider|crawler|wget|Mediapartners-Google/i.test(userAgentString);
}

function setBotFlag() {
    localStorage.setItem("isBot", "true");
}

function isBotDetected() {
    return localStorage.getItem("isBot") === "true";
}

function checkSpamAndRedirect() {
    const spamCount = localStorage.getItem("spamCount") || 0;
    const lastAttempts = JSON.parse(localStorage.getItem("lastAttempts")) || [];
    const now = Date.now();
    const thresholdAttempts = 5;
    const timeWindow = 10000;

    const recentAttempts = lastAttempts.filter(attempt => now - attempt < timeWindow);
    localStorage.setItem("lastAttempts", JSON.stringify(recentAttempts));

    if (recentAttempts.length >= thresholdAttempts) {
        window.location.href = '/404';
        return true;
    }

    recentAttempts.push(now);
    localStorage.setItem("lastAttempts", JSON.stringify(recentAttempts));

    localStorage.setItem("spamCount", recentAttempts.length);

    return false;
}

window.onload = function() {

    if (checkSpamAndRedirect()) {
        return;
    }

    if (isBotDetected() || isBotOrCurl(navigator.userAgent)) {
        if (!isBotDetected()) {
            setBotFlag();
        }
        window.location.href = '/404';
        return;
    }
    
    var path = window.location.pathname;
    var queryParams = new URLSearchParams(window.location.search);
    var id = queryParams.get('id');
    
    var expectedPath = '/Goto/';
    
    var redirections = {
	'mail': 'mailto:suryanarayanrenjith@gmail.com',
        'github': 'https://github.com/suryanarayanrenjith',
        'twitter': 'https://x.com/_suryanarayanr',
	'linkedin': 'https://www.linkedin.com/in/suryanarayan-renjith',
	'space-attack': 'https://space-attack.itch.io'
        };
    
    if (path.startsWith(expectedPath) && id && redirections[id]) {
        window.location.href = redirections[id];
    } else {
        window.location.href = '/404';
    }
};
    </script>
</head>
<body>
<style>
body {
display: flex;
justify-content: center;
align-items: center;
height: 100vh;
background-color: #f0f0f0;
margin: 0;
font-family: Arial, sans-serif;
}
	
.text {
font-size: 24px;
color: #333;
}	
</style>
<noscript>
<p>Please enable JavaScript for redirection.</p>
</noscript>	
<div class="text">
<span>Redirecting...</span>
</div>
</body>
</html>
