<!--@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@                    ,@@@@@@@@@@@@@@@                         ,@@@@@@@@@@
    @@@@.                          %@@@@@@@@@@@                              *@@@@@@
    @@,                             @@@@@@@@@@                                 &@@@@
    @.            &@@@@@@@@         @@@@@@@@@@            @@@@@@@@@             %@@@
    @           (@@@@@@@@@@@@@@@(((@@@@@@@@@@@           @@@@@@@@@@@@            @@@
    @           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@#           @@@
    @             @@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@,           @@@
    @@                 @@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@           @@@@
    @@@                      *@@@@@@@@@@@@@@@@           @@@@@@@@@             @@@@@
    @@@@@@                        @@@@@@@@@@@@           @@@                @@@@@@@@
    @@@@@@@@@@                      @@@@@@@@@@           @&             @@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@                @@@@@@@@@           @@@&              @@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@             @@@@@@@@           @@@@@@,             @@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@.           @@@@@@@@           @@@@@@@@@             @@@@@
    @/      @@@@@@@@@@@@@@            @@@@@@@@           @@@@@@@@@@@             @@@
               @@@@@@@@@             @@@@@@@@@           @@@@@@@@@@@@*            @@
    @                               @@@@@@@@@@           @@@@@@@@@@@@@@            @
    @@                            @@@@@@@@@@@@           @@@@@@@@@@@@@@@            
    @@@@@                     %@@@@@@@@@@@@@@@           @@@@@@@@@@@@@@@@           
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Surya Website" />
    <meta property="og:description" content="Fusing Imagination with Innovation." />
    <meta property="og:image" content="https://surya.is-a.dev/assets/bg.png" />
    <meta property="og:url" content="https://surya.is-a.dev/" />
    <meta property="og:type" content="website" />

    <!-- Resource hints for faster external resource loading -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://pages.surya-ops.workers.dev" crossorigin>
    <link rel="preconnect" href="https://surya-verify.vercel.app" crossorigin>
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://pages.surya-ops.workers.dev">
    <link rel="dns-prefetch" href="https://surya-verify.vercel.app">
    <link rel="dns-prefetch" href="https://uptime.surya-ops.workers.dev">

    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="/blocker.js" as="script">

    <script defer src="/blocker.js"></script>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "WebPage",
          "name": "Surya Website",
          "description": "Fusing Imagination with Innovation.",
          "url": "https://surya.is-a.dev/",
          "image": "https://surya.is-a.dev/assets/bg.png"
        }
    </script>
     <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0QSEZ9VSPZ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0QSEZ9VSPZ');
    </script> 
    <title>Suryanarayan Renjith</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"></noscript>
    <script>
  (async function verifyAndProceed() {
    function getFingerprint() {
      return `${navigator.userAgent}-${screen.width}-${screen.height}-${navigator.language}-${window.devicePixelRatio}`;
    }
    
    const now = Date.now();
    const lastRefresh = localStorage.getItem('lastRefresh');
    let suspicious = false;
    
    if (lastRefresh && (now - parseInt(lastRefresh, 10) < 2000)) {
      suspicious = true;
    }
    localStorage.setItem('lastRefresh', now);
    
    try {
      const response = await fetch('https://surya-verify.vercel.app/api/verify-user', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          fingerprint: getFingerprint(),
          suspicious: suspicious
        })
      });
      
      const data = await response.json();

      if (data.suspicious === true || !data.verified) {
        window.location.href = '/404';
        return;
      }
      
      console.log('User verified. Proceeding to the site...');
    } catch (error) {
      console.error('Error verifying user');
    }
  })();
        
(async function() {
    function block() {
      window.location.href = '/policy.html';
    }

    try {
      const res = await fetch('https://surya-verify.vercel.app/api/verify-proxy', {
        method: 'GET',
        mode: 'cors',
        credentials: 'omit'
      });

      if (!res.ok) return block();

      const data = await res.json();
      if (typeof data !== 'boolean') return block();

      if (data) return block();

    } catch (err) {
      console.error('Proxy check error');
      block();
    }
  })(); 
</script>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const fullText = "Suryanarayan Renjith";
        const fixedChar = "S";
        const dynamicText = fullText.slice(1);
        let index = 0;
        let isDeleting = false;
    
        function type() {
            if (document.hidden) {
                setTimeout(type, 500);
                return;
            }
            const speed = 300;
    
            if (isDeleting) {
                document.title = fixedChar + dynamicText.substring(0, index - 1);
                index--;
                if (index === 0) {
                    isDeleting = false;
                }
            } else {
                document.title = fixedChar + dynamicText.substring(0, index + 1);
                index++;
                if (index === dynamicText.length) {
                    isDeleting = true;
                }
            }
    
            setTimeout(type, speed);
        }
    
        type();
});
    </script>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png" fetchpriority="high">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="assets/favicon/site.webmanifest">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<script>
(function() {
    if (sessionStorage.getItem('suryaLightTheme') === 'true') {
        document.body.classList.add('light-theme');
        window.__lightThemeOnLoad = true;
    }
})();
</script>

<style>
#fa-test {
    position: absolute;
    visibility: hidden;
}

#content.transitioning {
    will-change: transform, opacity, filter;
    pointer-events: none;
}
.slide-out-up { animation: slideOutUp 0.42s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.slide-out-down { animation: slideOutDown 0.42s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.slide-out-left { animation: slideOutLeft 0.42s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.slide-out-right { animation: slideOutRight 0.42s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.slide-in-from-bottom { animation: slideInFromBottom 0.65s cubic-bezier(0.16, 1, 0.3, 1) both; }
.slide-in-from-top { animation: slideInFromTop 0.65s cubic-bezier(0.16, 1, 0.3, 1) both; }
.slide-in-from-left { animation: slideInFromLeft 0.65s cubic-bezier(0.16, 1, 0.3, 1) both; }
.slide-in-from-right { animation: slideInFromRight 0.65s cubic-bezier(0.16, 1, 0.3, 1) both; }
.m-slide-out-up { animation: mSlideOutUp 0.38s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.m-slide-out-down { animation: mSlideOutDown 0.38s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.m-slide-out-left { animation: mSlideOutLeft 0.38s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.m-slide-out-right { animation: mSlideOutRight 0.38s cubic-bezier(0.55, 0, 0.7, 0.2) forwards; }
.m-slide-in-from-bottom { animation: mSlideInFromBottom 0.6s cubic-bezier(0.16, 1, 0.3, 1) both; }
.m-slide-in-from-top { animation: mSlideInFromTop 0.6s cubic-bezier(0.16, 1, 0.3, 1) both; }
.m-slide-in-from-left { animation: mSlideInFromLeft 0.6s cubic-bezier(0.16, 1, 0.3, 1) both; }
.m-slide-in-from-right { animation: mSlideInFromRight 0.6s cubic-bezier(0.16, 1, 0.3, 1) both; }

@keyframes slideOutUp {
    0%   { transform: translateY(0) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: translateY(-50px) scale(0.95); opacity: 0; filter: blur(6px); }
}
@keyframes slideOutDown {
    0%   { transform: translateY(0) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: translateY(50px) scale(0.95); opacity: 0; filter: blur(6px); }
}
@keyframes slideOutLeft {
    0%   { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateX(-80px) rotateY(4deg) scale(0.96); opacity: 0; filter: blur(4px); }
}
@keyframes slideOutRight {
    0%   { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateX(80px) rotateY(-4deg) scale(0.96); opacity: 0; filter: blur(4px); }
}
@keyframes slideInFromBottom {
    0%   { transform: translateY(70px) scale(0.93); opacity: 0; filter: blur(8px); }
    50%  { opacity: 0.7; filter: blur(2px); }
    100% { transform: translateY(0) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes slideInFromTop {
    0%   { transform: translateY(-70px) scale(0.93); opacity: 0; filter: blur(8px); }
    50%  { opacity: 0.7; filter: blur(2px); }
    100% { transform: translateY(0) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes slideInFromLeft {
    0%   { transform: perspective(1200px) translateX(-90px) rotateY(5deg) scale(0.95); opacity: 0; filter: blur(6px); }
    50%  { opacity: 0.7; filter: blur(1.5px); }
    100% { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes slideInFromRight {
    0%   { transform: perspective(1200px) translateX(90px) rotateY(-5deg) scale(0.95); opacity: 0; filter: blur(6px); }
    50%  { opacity: 0.7; filter: blur(1.5px); }
    100% { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes mSlideOutUp {
    0%   { transform: perspective(1200px) translateY(0) rotateX(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateY(-35px) rotateX(12deg) scale(0.92); opacity: 0; filter: blur(4px); }
}
@keyframes mSlideOutDown {
    0%   { transform: perspective(1200px) translateY(0) rotateX(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateY(35px) rotateX(-12deg) scale(0.92); opacity: 0; filter: blur(4px); }
}
@keyframes mSlideOutLeft {
    0%   { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateX(-50px) rotateY(15deg) scale(0.92); opacity: 0; filter: blur(3px); }
}
@keyframes mSlideOutRight {
    0%   { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
    100% { transform: perspective(1200px) translateX(50px) rotateY(-15deg) scale(0.92); opacity: 0; filter: blur(3px); }
}
@keyframes mSlideInFromBottom {
    0%   { transform: perspective(1200px) translateY(50px) rotateX(-8deg) scale(0.9); opacity: 0; filter: blur(6px); }
    60%  { filter: blur(1px); }
    100% { transform: perspective(1200px) translateY(0) rotateX(0deg) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes mSlideInFromTop {
    0%   { transform: perspective(1200px) translateY(-50px) rotateX(8deg) scale(0.9); opacity: 0; filter: blur(6px); }
    60%  { filter: blur(1px); }
    100% { transform: perspective(1200px) translateY(0) rotateX(0deg) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes mSlideInFromLeft {
    0%   { transform: perspective(1200px) translateX(-60px) rotateY(12deg) scale(0.9); opacity: 0; filter: blur(5px); }
    60%  { filter: blur(1px); }
    100% { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
}
@keyframes mSlideInFromRight {
    0%   { transform: perspective(1200px) translateX(60px) rotateY(-12deg) scale(0.9); opacity: 0; filter: blur(5px); }
    60%  { filter: blur(1px); }
    100% { transform: perspective(1200px) translateX(0) rotateY(0deg) scale(1); opacity: 1; filter: blur(0px); }
}

.offline-message {
    display: none;
    position: fixed;
    top: 20%;
    left: 0;
    width: 100%;
    background-color: black;
    color: white;
    padding: 15px;
    text-align: center;
    font-size: 18px;
    z-index: 1000;
}
@media only screen and (max-width: 600px) {
    .offline-message { font-size: 14px; padding: 10px; }
}
@media only screen and (min-width: 601px) and (max-width: 1024px) {
    .offline-message { font-size: 16px; }
}

#preloader {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    z-index: 10000;
    overflow: hidden;
}
body.light-theme #preloader { background: #f5f5f5; }
#preloaderCanvas {
    display: block;
    width: 100%; height: 100%;
}

*, *::before, *::after { -webkit-tap-highlight-color: transparent; }
button, a, .tab-button, .shortcut-key, .shortcuts-list li { outline: none; }
</style>

<i id="fa-test" class="fa-solid fa-circle-exclamation"></i>

<script>
    function isFontAwesomeLoaded() {
    const testIcon = document.getElementById('fa-test');
    const iconWidth = window.getComputedStyle(testIcon).width;   
    if (!iconWidth || parseFloat(iconWidth) === 0) {
        alert("Font Awesome icons are not loading correctly. Please whitelist the Font Awesome CDN in your ad blocker settings to ensure proper icon display.");
    }
}
window.onload = isFontAwesomeLoaded;
</script>

<script>
function isDesktop() {
    return window.innerWidth > 768 && !("ontouchstart" in window || navigator.maxTouchPoints > 0);
  }

  function initializeCursor() {
    document.body.classList.add("custom-cursor-active");

    const cursorDot = document.createElement("div");
    cursorDot.classList.add("cursor-dot");
    document.body.appendChild(cursorDot);

    const cursorOutline = document.createElement("div");
    cursorOutline.classList.add("cursor-dot-outline");
    document.body.appendChild(cursorOutline);

    let mouseX = 0;
    let mouseY = 0;
    let outlineX = 0;
    let outlineY = 0;
    let dotX = 0;
    let dotY = 0;

    document.addEventListener("mousemove", (e) => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    function animateCursor() {
      outlineX += (mouseX - outlineX) * 0.15;
      outlineY += (mouseY - outlineY) * 0.15;

      dotX += (mouseX - dotX) * 0.1;
      dotY += (mouseY - dotY) * 0.1;

      cursorOutline.style.left = `${outlineX}px`;
      cursorOutline.style.top = `${outlineY}px`;
      cursorDot.style.left = `${dotX}px`;
      cursorDot.style.top = `${dotY}px`;

      requestAnimationFrame(animateCursor);
    }

    animateCursor();

    const hoverSelector = 'a, button, [role="button"], input[type="submit"], .hover-target, .tab-button, .shortcut-key, .shortcuts-list li, .action-button, .music-button, .help-button, .close-modal, [onclick], [data-section]';

    const addCursorHoverEffect = () => {
      document.body.classList.add("cursor-hover");
    };

    const removeCursorHoverEffect = () => {
      document.body.classList.remove("cursor-hover");
    };

    function bindHoverListeners(root) {
      root.querySelectorAll(hoverSelector).forEach((el) => {
        if (el.dataset.cursorBound) return;
        el.dataset.cursorBound = '1';
        el.addEventListener("mouseenter", addCursorHoverEffect);
        el.addEventListener("mouseleave", removeCursorHoverEffect);
      });
    }

    bindHoverListeners(document);

    // Re-bind hover listeners when dynamic content is loaded
    const observer = new MutationObserver((mutations) => {
      for (const m of mutations) {
        for (const node of m.addedNodes) {
          if (node.nodeType === 1) bindHoverListeners(node.parentElement || document);
        }
      }
    });
    observer.observe(document.body, { childList: true, subtree: true });
  }

  if (isDesktop()) {
    initializeCursor();
  }
      </script>
    
    <header>
        <nav class="menu-bar">
            <ul>
                <li><a href="#" data-section="home">Home</a></li>
                <li><a href="#" data-section="about">About</a></li>
                <li><a href="#" data-section="projects">Projects</a></li>
                <li><a href="#" data-section="resume">Resume</a></li>
                <li class="music-button-container" id="buttonhide">
                    <button class="music-button" id="unmuteButton" aria-label="Toggle Music">
                        <i class="fas fa-volume-mute"></i>
                    </button>
                    <button class="music-button hidden" id="muteButton" aria-label="Toggle Music">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </header>

    <div class="progress-bar"><div></div></div>

    <div id="keyboard-popups">
            <button class="help-button" id="helpButton">
                <i class="fa-solid fa-info"></i>
            </button>
            <div class="modal-overlay" id="modalOverlay"></div>
            <div class="shortcuts-modal" id="shortcutsModal">
                <button class="close-modal" id="closeModal">&times;</button>
                <div class="modal-container">
                    <div class="modal-tabs">
                        <button class="tab-button active" data-tab="about">About</button>
                        <button class="tab-button" data-tab="keyboard">Keyboard</button>
                        <button class="tab-button" data-tab="terminal">Terminal</button>
                        <button class="tab-button" data-tab="client">Client</button>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="about-tab">
                            <div class="about-section">
                                <div class="favicon-container">
                                    <img src="/assets/favicon/android-chrome-512x512.png" alt="Favicon" class="favicon" loading="lazy" decoding="async" width="80" height="80" />
                                </div>
                                <h3 class="website-title">Surya Website</h3>
                                <p id="yearRange">
                                    <i class="fa-regular fa-calendar"></i>
                                    Since 2023
                                </p>                                  
                                <p id="uptimeResponseTime" class="uptime-response-time">Loading…</p>
                                <p class="made-with">Made with <span class="heart"> <i class="fa-solid fa-heart"></i> </span> by Suryanarayan Renjith.</p>
                            </div>
                        </div>
                        <div class="tab-pane" id="keyboard-tab">
                            <ul class="shortcuts-list">
                                <li data-action="toggle-info"><span class="shortcut-key">Ctrl + Shift + /</span> Open Info Section</li>
                                <li data-action="go-home"><span class="shortcut-key">Ctrl + Shift + 5</span> Go to Home section</li>
                                <li data-action="go-about"><span class="shortcut-key">Ctrl + Shift + 6</span> Go to About section</li>
                                <li data-action="go-projects"><span class="shortcut-key">Ctrl + Shift + 7</span> Go to Projects section</li>
                                <li data-action="go-resume"><span class="shortcut-key">Ctrl + Shift + 8</span> Go to Resume section</li>
                                <li data-action="open-terminal"><span class="shortcut-key">Ctrl + Shift + K</span> Open Terminal in new tab</li>
                                <li data-action="open-links"><span class="shortcut-key">Ctrl + Shift + L</span> Open Links in the same tab</li>
                                <li data-action="open-resume"><span class="shortcut-key">Ctrl + Shift + V</span> Open Resume in new tab</li>
                            </ul>
                        </div>
                        <div class="tab-pane" id="terminal-tab">
                            <div class="terminal-info">
                                <p>Access the terminal to run commands and interact with this portfolio directly.</p>
                                <button class="action-button" id="openTerminal">
                                    <i class="fa-solid fa-terminal"></i> Open Terminal
                                </button>
                                <div class="terminal-logs">
                                    <code></code>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="client-tab">
                            <div class="client-info">
                                <p>Download my portfolio client to access my portfolio anytime with ease.</p>
                                <button class="action-button" id="downloadClient">
                                    <i class="fa-solid fa-download"></i> Download Client
                                </button>
                                <div class="client-logs">
                                    <code></code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', () => {

              const keyValue     = 'uptimeResponseTime';
              const keyTimestamp = 'uptimeResponseTimeTimestamp';
              const now          = Date.now();
              const dayMs        = 24 * 60 * 60 * 1000;
          
              const el = document.getElementById('uptimeResponseTime');
              function setUI(val) {
                if (el) el.textContent = `Last checked response time: ${val}`;
              }
          
              const cachedVal = localStorage.getItem(keyValue);
              const cachedTs  = parseInt(localStorage.getItem(keyTimestamp), 10);
              if (cachedVal && cachedTs && (now - cachedTs < dayMs)) {
                setUI(cachedVal);
              } else {
                fetch('https://uptime.surya-ops.workers.dev/')
                  .then(res => res.json())
                  .then(data => {
                    const rt = data.responseTime;
                    setUI(rt);
                    localStorage.setItem(keyValue, rt);
                    localStorage.setItem(keyTimestamp, now.toString());
                  })
                  .catch(() => {
                    setUI('--');
                  });
              }
          
              const header = document.querySelector('header');
              const helpButton        = document.getElementById('helpButton');
              const modalOverlay      = document.getElementById('modalOverlay');
              const shortcutsModal    = document.getElementById('shortcutsModal');
              const closeModal        = document.getElementById('closeModal');
              const openTerminalBtn   = document.getElementById('openTerminal');
              const downloadClientBtn = document.getElementById('downloadClient');
              const tabButtons        = document.querySelectorAll('.tab-button');
              const aboutBtn          = document.querySelector('.tab-button[data-tab="about"]');
              const keyboardBtn       = document.querySelector('.tab-button[data-tab="keyboard"]');
              const terminalTabBtn    = document.querySelector('.tab-button[data-tab="terminal"]');
              const clientBtn         = document.querySelector('.tab-button[data-tab="client"]');
          
              const ua                = navigator.userAgent.toLowerCase();
              const isMac             = /macintosh|mac os x/i.test(ua) || (navigator.platform && /Mac/i.test(navigator.platform));
              const modKey            = isMac ? '⌘' : 'Ctrl';
              const isWindowsClient   = /windows nt|win64|wow64/i.test(ua);
              const isAndroidClient   = /android/i.test(ua);
              const isMobileClient    = /mobile|tablet|iphone|ipad|ipod/i.test(ua);
              const isElectron        = ua.includes('electron');
              const isAndroidWebView  = /; wv\)/.test(navigator.userAgent);

              document.querySelectorAll('.shortcuts-list .shortcut-key').forEach(span => {
                span.textContent = span.textContent.replace(/Ctrl/g, modKey);
              });

              if (isElectron || isAndroidWebView) {
                document.querySelector('.tab-button[data-tab="client"]')?.remove();
                document.getElementById('client-tab')?.remove();
               }
          
              let shortcutsVisible = false;
              const showShortcuts = () => {
                modalOverlay.classList.add('active');
                shortcutsModal.style.display = 'block';
                shortcutsVisible = true;
                header.style.setProperty('display', 'none', 'important');
              };
              const hideShortcuts = () => {
                modalOverlay.classList.remove('active');
                shortcutsModal.style.display = 'none';
                shortcutsVisible = false;
                header.style.removeProperty('display', 'important');
              };
              const toggleShortcuts = () => {
                shortcutsVisible ? hideShortcuts() : showShortcuts();
              };
          
              helpButton.addEventListener('click', toggleShortcuts);
              closeModal.addEventListener('click', hideShortcuts);
              modalOverlay.addEventListener('click', e => {
                if (e.target === modalOverlay && shortcutsVisible) hideShortcuts();
              });
          
              const launchTerminal = () => {
                const terminalLogs = document.querySelector('.terminal-logs code');
                try {
                  const now = new Date().toLocaleTimeString();
                  terminalLogs.textContent = `${now}: Opening terminal...`;
          
                  const link = document.createElement('a');
                  link.href   = '/Cli';
                  link.target = '_blank';
                  link.rel    = 'noopener noreferrer';
                  link.style.display = 'none';
                  document.body.appendChild(link);
                  link.click();
                  link.remove();
          
                  terminalLogs.textContent += `\n${new Date().toLocaleTimeString()}: Terminal session started. Type 'help' for available commands.`;
                } catch (err) {
                  const errorTime = new Date().toLocaleTimeString();
                  terminalLogs.textContent += `\n${errorTime}: Failed to open terminal ("${err.message}").`;
                }
              };
          
              const downloadInstaller = (force = false) => {
              const clientLogs = document.querySelector('.client-logs code');
              const ua         = navigator.userAgent || '';
            
              const isWindowsClient = /windows nt|win64|wow64/i.test(ua);
              const isAndroidClient = /android/i.test(ua);
              const isMobileClient  = /mobile|tablet|iphone|ipad|ipod/i.test(ua);
              const isLinuxClient   = /linux/i.test(ua) && !isAndroidClient && !isWindowsClient && !isMobileClient;
            
              const wantApk        = isAndroidClient || (isMobileClient && !isWindowsClient);
              const wantAppImage   = isLinuxClient;
              const wantExe        = isWindowsClient;
              const canDownload    = wantApk || wantAppImage || wantExe;
            
              if (!canDownload && !force) {
                clientLogs.textContent = `${new Date().toLocaleTimeString()}: This installer is built for Windows, Linux and Android only. If you'd still like to download the file, click below.`;
                clientLogs.innerHTML += `\n<a href="#" id="forceDownloadLink" style="color:white;">Download .exe anyway...</a>`;
                document.getElementById('forceDownloadLink')?.addEventListener('click', e => {
                  e.preventDefault();
                  downloadInstaller(true);
                });
                return;
              }
            
              clientLogs.textContent = `${new Date().toLocaleTimeString()}: Connecting to download server...`;
            
              const params = [];
              if (wantApk)  params.push('apk=true');
              if (force)    params.push('force=true');
              const endpoint = `https://surya-verify.vercel.app/api/installer${params.length ? '?' + params.join('&') : ''}`;
            
              fetch(endpoint)
                .then(async response => {
                  const ct = response.headers.get('Content-Type') || '';
                  if (ct.includes('application/json')) {
                    const json = await response.json();
                    const t    = new Date().toLocaleTimeString();
                    const msg  = json.message || json.error || 'Unknown response';
                    clientLogs.textContent += `\n${t}: ${msg}`;
                    if (json.forceUrl) {
                      clientLogs.innerHTML += `\n<a href="#" id="forceDownloadLink2" style="color:white;">Download anyway...</a>`;
                      document.getElementById('forceDownloadLink2')?.addEventListener('click', e => {
                        e.preventDefault();
                        window.location.href = json.forceUrl;
                      });
                    }
                    throw new Error('handled-json');
                  }
                  if (!response.ok) {
                    throw new Error(`Server responded with ${response.status}`);
                  }
            
                      const disposition = response.headers.get('Content-Disposition') || '';
                      const m           = disposition.match(/filename="?([^";]+)"?/i);
                      const fileName    = m
                        ? m[1]
                        : wantApk
                          ? 'SuryaWebsiteApp.apk'
                          : wantAppImage
                            ? 'SuryaWebsiteApp.AppImage'
                            : 'SuryaWebsiteApp.exe';
                
                      const blob = await response.blob();
                      clientLogs.textContent += `\n${new Date().toLocaleTimeString()}: Fetching "${fileName}"...`;
                
                      const url = URL.createObjectURL(blob);
                      const a   = document.createElement('a');
                      a.href     = url;
                      a.download = fileName;
                      document.body.appendChild(a);
                      a.click();
                      a.remove();
                      URL.revokeObjectURL(url);
                
                      clientLogs.textContent += `\n${new Date().toLocaleTimeString()}: "${fileName}" fetched successfully.`;
                    })
                    .catch(err => {
                      if (err.message === 'handled-json') return;
                      const t = new Date().toLocaleTimeString();
                      clientLogs.textContent += `\n${t}: Download failed ("${err.message}"). Please try again later.`;
                    });
                };
                
                tabButtons.forEach(btn => {
                  btn.addEventListener('click', () => {
                    tabButtons.forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(`${btn.dataset.tab}-tab`)?.classList.add('active');
                  });
                });
                openTerminalBtn?.addEventListener('click', launchTerminal);
                downloadClientBtn?.addEventListener('click', () => downloadInstaller(false));

          
              document.querySelectorAll('.shortcuts-list li').forEach(li => {
                const action = li.dataset.action;
                if (!action) return;
                li.style.cursor = 'pointer';
                li.addEventListener('click', () => {
                  switch (action) {
                    case 'toggle-info':   toggleShortcuts(); break;
                    case 'go-home':       navigateToSection?.('home', 'none'); break;
                    case 'go-about':      navigateToSection?.('about', 'none'); break;
                    case 'go-projects':   navigateToSection?.('projects', 'none'); break;
                    case 'go-resume':     navigateToSection?.('resume', 'none'); break;
                    case 'open-terminal': launchTerminal(); break;
                    case 'open-links':    setTimeout(() => window.open('/?section=links','_self'), 100); break;
                    case 'open-resume':   setTimeout(() => window.open('/Resume','_blank'), 100); break;
                  }
                });
              });
          
              document.addEventListener('keydown', event => {
                if (shortcutsVisible && !event.ctrlKey && !event.metaKey && !event.shiftKey) {
                    switch (event.key.toLowerCase()) {
                      case 'a': aboutBtn?.click();      break;
                      case 'k': keyboardBtn?.click();   break;
                      case 't': terminalTabBtn?.click();break;
                      case 'c': if (clientBtn && !isElectron) clientBtn.click(); break;
                    }
                  }
                const modPressed = isMac ? event.metaKey : event.ctrlKey;
                if (modPressed && event.shiftKey) {
                  if (['Slash','/','?'].includes(event.key) || event.code === 'Slash') {
                    event.preventDefault();
                    toggleShortcuts();
                    return;
                  }
                  switch (event.code) {
                    case 'Digit5': event.preventDefault(); navigateToSection?.('home', 'none'); break;
                    case 'Digit6': event.preventDefault(); navigateToSection?.('about', 'none'); break;
                    case 'Digit7': event.preventDefault(); navigateToSection?.('projects', 'none'); break;
                    case 'Digit8': event.preventDefault(); navigateToSection?.('resume', 'none'); break;
                    case 'KeyK':   event.preventDefault(); launchTerminal(); break;
                    case 'KeyL':   event.preventDefault(); setTimeout(()=>window.open('/?section=links','_self'),100); break;
                    case 'KeyV':   event.preventDefault(); setTimeout(()=>window.open('/Resume','_blank'),100); break;
                  }
                }
              });
            });
          </script>
    
    <noscript>
        <div class="offline-message" style="display: block;">
            Please enable JavaScript to use this website.
        </div>
    </noscript>

    <script>   
        const CLOUD_FLARE_WORKER_URL = 'https://pages.surya-ops.workers.dev/';
        
        let isMobile = /Mobi|Android/i.test(navigator.userAgent);
        
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams       = new URLSearchParams(window.location.search);
            const sectionFromQuery = urlParams.get('section');
            const sectionFromHash  = window.location.hash.substring(1);
            const sectionFromStorage = sessionStorage.getItem('lastSection');
            const sectionToLoad = sectionFromQuery
                                || sectionFromHash
                                || sectionFromStorage
                                || 'home';
            currentSectionIndex = sectionOrder.indexOf(sectionToLoad);
            showContent(sectionToLoad);
            updateProgressBar(sectionToLoad);
        });
        
        function showContent(section, direction = 'none') {
            const content = document.getElementById('content');

            content.className = content.className
                .replace(/\b(slide-out|slide-in|m-slide-out|m-slide-in)[^\s]*/g, '')
                .replace(/\btransitioning\b/, '')
                .trim();
            content.style.transition = '';
            content.style.opacity = '';

            if (direction === 'none') {
                content.style.opacity = '0';
                fetch(`${CLOUD_FLARE_WORKER_URL}?section=${section}`)
                    .then(response => response.text())
                    .then(html => {
                        content.innerHTML = html;
                        content.style.transition = 'opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1)';
                        content.style.opacity = '1';
                        sessionStorage.setItem('lastSection', section);
                    })
                    .catch(error => {
                        console.error('Error fetching content:', error);
                        content.innerHTML = '<p>Error loading content.</p>';
                        content.style.opacity = '1';
                    });
                return;
            }

            const prefix = isMobile ? 'm-' : '';
            const exitMap  = { down: 'slide-out-up', up: 'slide-out-down', left: 'slide-out-right', right: 'slide-out-left' };
            const enterMap = { down: 'slide-in-from-bottom', up: 'slide-in-from-top', left: 'slide-in-from-left', right: 'slide-in-from-right' };
            const exitClass  = prefix + exitMap[direction];
            const enterClass = prefix + enterMap[direction];
            const exitDuration  = isMobile ? 380 : 420;
            const enterDuration = isMobile ? 600 : 650;

            content.classList.add('transitioning', exitClass);

            const fetchPromise = fetch(`${CLOUD_FLARE_WORKER_URL}?section=${section}`)
                .then(response => response.text());
            const exitPromise = new Promise(resolve => setTimeout(resolve, exitDuration));

            Promise.all([fetchPromise, exitPromise])
                .then(([html]) => {
                    content.classList.remove(exitClass);
                    content.innerHTML = html;
                    sessionStorage.setItem('lastSection', section);

                    void content.offsetWidth;

                    content.classList.add(enterClass);
                    setTimeout(() => {
                        content.classList.remove(enterClass, 'transitioning');
                    }, enterDuration + 50);
                })
                .catch(error => {
                    console.error('Error fetching content:', error);
                    content.classList.remove(exitClass, 'transitioning');
                    content.innerHTML = '<p>Error loading content.</p>';
                    content.style.opacity = '1';
                });
        }
        
        const sectionOrder = ['home', 'about', 'projects', 'resume'];
        let currentSectionIndex = 0;
        let isThrottled = false;
        
        function updateProgressBar(section) {
            const progressBar = document.querySelector('.progress-bar div');
            const index = sectionOrder.indexOf(section);
            const progress = index / (sectionOrder.length - 1) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function navigateToSection(section, direction) {
            const idx = sectionOrder.indexOf(section);
            if (idx !== -1) currentSectionIndex = idx;
            showContent(section, direction);
            updateProgressBar(section);
            window.dispatchEvent(new CustomEvent('sectionChanged'));
        }

        document.querySelectorAll('.menu-bar a').forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const section = event.target.getAttribute('data-section');
                navigateToSection(section, 'none');
            });
        });
        
        function switchToNextSection(direction) {
            if (isThrottled) return;
            isThrottled = true;
            setTimeout(() => { isThrottled = false; }, 1200);
        
            if (direction === 'down' || direction === 'right') {
                currentSectionIndex = (currentSectionIndex + 1) % sectionOrder.length;
            } else if (direction === 'up' || direction === 'left') {
                currentSectionIndex = (currentSectionIndex - 1 + sectionOrder.length) % sectionOrder.length;
            }
        
            const nextSection = sectionOrder[currentSectionIndex];
            showContent(nextSection, direction);
            updateProgressBar(nextSection);
            window.dispatchEvent(new CustomEvent('sectionChanged'));
        }
        
            let wheelAccumulator = 0;
            let wheelTimer;
            const WHEEL_THRESHOLD = 60;
            
            window.addEventListener('wheel', event => {
              wheelAccumulator += event.deltaY;
              
              clearTimeout(wheelTimer);
              wheelTimer = setTimeout(() => {
                wheelAccumulator = 0;
              }, 250);
              
              if (Math.abs(wheelAccumulator) >= WHEEL_THRESHOLD) {
                if (wheelAccumulator > 0) {
                  switchToNextSection('down');
                } else {
                  switchToNextSection('up');
                }
                wheelAccumulator = 0;
              }
            }, { passive: true });
        
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        
        window.addEventListener('touchstart', (event) => {
            touchStartX = event.changedTouches[0].screenX;
            touchStartY = event.changedTouches[0].screenY;
        });
        
        window.addEventListener('touchend', (event) => {
            touchEndX = event.changedTouches[0].screenX;
            touchEndY = event.changedTouches[0].screenY;
            handleGesture();
        });
        
        function handleGesture() {
            const deltaX = touchStartX - touchEndX;
            const deltaY = touchStartY - touchEndY;
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                if (isMobile) {
                    if (deltaX > 50) {
                        switchToNextSection('right');
                    } else if (deltaX < -50) {
                        switchToNextSection('left');
                    }
                } else {
                    if (deltaX > 50) {
                        switchToNextSection('left');
                    } else if (deltaX < -50) {
                        switchToNextSection('right');
                    }
                }
            } else {
                if (deltaY > 50) {
                    switchToNextSection('down');
                } else if (deltaY < -50) {
                    switchToNextSection('up');
                }
            }
        }
        
        showContent('home', 'none');
        updateProgressBar('home');
    </script>
    
    <div id="music-popup">
        <div id="popup-content">
            <p>Would you like to enable music on this website?</p>
            <button id="enable-music">Yes</button>
            <button id="disable-music">No</button>
        </div>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
    var popup = document.getElementById('music-popup');
    var audio = new Audio('/assets/bg_music.mp3');
    audio.loop = true;
    var animationsTriggered = false;
    var container = document.querySelector('.container');
    var header = document.querySelector('header');
    var helpButton = document.querySelector('.help-button');
    var uButton = document.getElementById('unmuteButton');
    var mButton = document.getElementById('muteButton');
    var buttonhide = document.getElementById('buttonhide');
    var menubar = document.querySelector('.menu-bar');
    var modalOverlay = document.querySelector('.modal-overlay');
    var keydownEventListener;

    uButton.classList.add('hidden');
    mButton.classList.add('hidden');

    function autoCollapse() {
        buttonhide.style.display = 'none';
        menubar.style.marginRight = '-20px';
        buttonhide.style.pointerEvents = 'none';
    }

    function expandHeader() {
        buttonhide.style.display = 'block';
        menubar.style.marginRight = '5px';
        buttonhide.style.pointerEvents = 'auto';
    }

    function isMobileDevice() {
        if (navigator.userAgentData) {
            return navigator.userAgentData.mobile;
        }
        
        const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i;
        return mobileRegex.test(navigator.userAgent);
    }

    if (!isMobileDevice()) {
    setTimeout(autoCollapse, 20000);
    header.addEventListener('mouseenter', expandHeader);
    header.addEventListener('mouseleave', autoCollapse);
    }

    function preloadAudio() {
        audio.preload = 'auto';
        audio.load();
    }

    function showPopup() {
        popup.style.display = 'flex';
        container.classList.add('disabled-container');
        header.classList.add('no-display');
        helpButton.classList.add('hidden');
        modalOverlay.classList.add('hidden');
        document.addEventListener('keydown', keydownEventListener);
    }

    function playMusic() {
        audio.play().then(() => {
            sessionStorage.setItem('musicPlaying', 'true');
            hidePopup();
            toggleMusicButtons();
        }).catch((error) => {
            console.error('Playback issue:', error);
            alert('Playback issue: Autoplay is not supported on this browser.');
            header.removeEventListener('mouseenter', expandHeader);
            autoCollapse();
            hidePopup();
        });
    }

    function hidePopup() {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        document.removeEventListener('keydown', keydownEventListener);
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
    }

    function toggleMusicButtons() {
        uButton.classList.toggle('hidden');
        mButton.classList.toggle('hidden');
    }

    unmuteButton.addEventListener('click', function() {
        playMusic();
    });

    muteButton.addEventListener('click', function() {
        audio.pause();
        sessionStorage.setItem('musicPlaying', 'false');
        toggleMusicButtons();
    });

    document.getElementById('enable-music').addEventListener('click', function() {
        playMusic();
    });

    document.getElementById('disable-music').addEventListener('click', function() {
        audio.pause();
        sessionStorage.setItem('musicPlaying', 'false');
        sessionStorage.setItem('musicPopupDisabled', 'true');
        hidePopup();
    });

    function startAnimations() {
        var menuBar = document.querySelector('.menu-bar');
        menuBar.classList.add('animate-menu-bar');

        var menuItems = document.querySelectorAll('.menu-bar ul li');
        menuItems.forEach(function(item, index) {
            setTimeout(function() {
                item.classList.add('animate-menu-item');
            }, index * 100);
        });
    }

    keydownEventListener = function(event) {
        if (event.key === 'Enter') {
            document.getElementById('enable-music').click();
        } else if (event.key === 'Backspace') {
            document.getElementById('disable-music').click();
        }
    };

    preloadAudio();

    const params = new URLSearchParams(window.location.search);
    const currentSection = params.get('section') || '';

    if (currentSection === 'links') {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
        if (sessionStorage.getItem('musicPlaying') === 'true') {
            audio.play().then(() => {
                toggleMusicButtons();
            }).catch(() => {});
        }
        return;
    }
    
    if (!sessionStorage.getItem('musicPopupDisabled')) {
        showPopup();
    } else {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
        if (sessionStorage.getItem('musicPlaying') === 'true') {
            audio.play().then(() => {
                toggleMusicButtons();
            }).catch(() => {});
        }
    }
});   
</script>

    <div class="container" id="content"></div>
    
    <div id="preloader">
        <canvas id="preloaderCanvas"></canvas>
    </div>

<div class="matrix-overlay" id="matrixOverlay">
    <div class="matrix-popup">
        <div class="matrix-header">
            <div class="status-indicator"></div>
            <span class="access-text">ACCESS GRANTED</span>
            <div class="close-btn" onclick="closePopup()">×</div>
        </div>
        
        <div class="matrix-content">
            <div class="matrix-rain" id="matrixRain"></div>
            
            <div class="content-wrapper">
                <div class="matrix-logo">
                    <span class="matrix-text">MATRIX</span>
                    <div class="underline"></div>
                </div>
                
                <div class="matrix-message">
                    <p>Digital realm access authorized</p>
                    <p class="sub-text">Ready to enter the simulation?</p>
                </div>
                
                <div class="button-group">
                    <button class="matrix-btn primary" onclick="enterMatrix()">
                        <span>ENTER</span>
                        <div class="btn-underline"></div>
                    </button>
                    <button class="matrix-btn secondary" onclick="closePopup()">
                        <span>BACK</span>
                    </button>
                </div>
            </div>
            
            <div class="countdown" id="countdown">10</div>
        </div>
    </div>
</div>

<script>
(function() {
    const SECRET_SEQUENCE = ['KeyM','KeyA','KeyT','KeyR','KeyI','KeyX'];
    let buffer = [];
    let countdownTimer;
    let countdownValue = 10;

    function createMatrixRain() {
        const rainContainer = document.getElementById('matrixRain');
        if (!rainContainer) return;
        
        const chars = ['0', '1', '|', '-', '/', '\\', '.', '*'];
        
        for (let i = 0; i < 15; i++) {
            setTimeout(() => {
                const char = document.createElement('div');
                char.className = 'rain-char';
                char.textContent = chars[Math.floor(Math.random() * chars.length)];
                char.style.left = Math.random() * 100 + '%';
                char.style.animationDelay = Math.random() * 2 + 's';
                char.style.animationDuration = (3 + Math.random() * 2) + 's';
                rainContainer.appendChild(char);
                
                setTimeout(() => {
                    if (char.parentNode) {
                        char.parentNode.removeChild(char);
                    }
                }, 4000);
            }, i * 150);
        }
    }

    function startCountdown() {
        const countdownEl = document.getElementById('countdown');
        if (!countdownEl) return;
        
        countdownTimer = setInterval(() => {
            countdownValue--;
            countdownEl.textContent = countdownValue;
            if (countdownValue <= 0) {
                enterMatrix();
            }
        }, 1000);
    }

    function showMatrixPopup() {
        const overlay = document.getElementById('matrixOverlay');
        if (!overlay) return;
        
        overlay.style.display = 'block';
        createMatrixRain();
        startCountdown();

        const rainInterval = setInterval(() => {
            if (overlay.style.display === 'block') {
                createMatrixRain();
            } else {
                clearInterval(rainInterval);
            }
        }, 2000);
    }

    window.closePopup = function() {
        const overlay = document.getElementById('matrixOverlay');
        if (overlay) overlay.style.display = 'none';
        if (countdownTimer) {
            clearInterval(countdownTimer);
            countdownValue = 10;
        }
    }

    window.enterMatrix = function() {
        window.location.href = '/Matrix';
        closePopup();
    }

    window.addEventListener('keydown', e => {
        buffer.push(e.code);
        
        if (buffer.length > SECRET_SEQUENCE.length) {
            buffer.shift();
        }
        
        if (
            buffer.length === SECRET_SEQUENCE.length &&
            SECRET_SEQUENCE.every((code, idx) => buffer[idx] === code)
        ) {
            showMatrixPopup();
            buffer = [];
        }
    });
})();

(function() {
    document.addEventListener('keydown', function(e) {
      const overlay = document.getElementById('matrixOverlay');
      if (!overlay) return;

      const style = window.getComputedStyle(overlay);
      if (style.display === 'none' || style.visibility === 'hidden' || overlay.classList.contains('hidden')) {
        return;
      }

      switch (e.key) {
        case 'Enter':
          e.preventDefault();
          enterMatrix();
          break;
        case 'Backspace':
          e.preventDefault();
          closePopup();
          break;
      }
    });
})();

document.addEventListener('DOMContentLoaded', function() {
    const popup = document.querySelector('.matrix-popup');
    const contentContainer = document.querySelector('.matrix-content');

    if (contentContainer) {
        contentContainer.style.perspective = '1500px';
    }

    let targetRotateX = 0, targetRotateY = 0, targetZ = 0;
    let currentRotateX = 0, currentRotateY = 0, currentZ = 0;
    let isHovering = false;
    const maxAngle = 20;
    const maxZ = 40;
    const lerpFactor = 0.12;

    function animate() {
        currentRotateX += (targetRotateX - currentRotateX) * lerpFactor;
        currentRotateY += (targetRotateY - currentRotateY) * lerpFactor;
        currentZ += (targetZ - currentZ) * lerpFactor;

        if (!isHovering && Math.abs(currentRotateX) < 0.5 && Math.abs(currentRotateY) < 0.5 && Math.abs(currentZ) < 0.5) {
            currentRotateX = 0;
            currentRotateY = 0;
            currentZ = 0;
            popup.style.transform = `translate(-50%, -50%) translateZ(0px) rotateX(0deg) rotateY(0deg)`;
            return;
        }

        popup.style.transform = 
            `translate(-50%, -50%) translateZ(${currentZ.toFixed(2)}px) ` +
            `rotateX(${currentRotateX.toFixed(2)}deg) rotateY(${currentRotateY.toFixed(2)}deg)`;

        requestAnimationFrame(animate);
    }

    function onMouseMove(e) {
        const rect = popup.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        const cx = rect.width / 2;
        const cy = rect.height / 2;
        const dx = (x - cx) / cx;
        const dy = (y - cy) / cy;

        targetRotateY = dx * maxAngle;
        targetRotateX = -dy * maxAngle;

        const normDist = Math.min(1, Math.sqrt(dx * dx + dy * dy) / Math.SQRT2);
        targetZ = (1 - 2 * normDist) * maxZ;
    }

    popup.addEventListener('mouseenter', function() {
        isHovering = true;
        popup.classList.add('hovered');
        if (Math.abs(currentRotateX) < 0.5 && Math.abs(currentRotateY) < 0.5 && Math.abs(currentZ) < 0.5) {
            animate();
        }
    });

    popup.addEventListener('mousemove', onMouseMove);

    popup.addEventListener('mouseleave', function() {
        isHovering = false;
        targetRotateX = 0;
        targetRotateY = 0;
        targetZ = 0;
        popup.classList.remove('hovered');
    });
});
</script>
    
    <footer>
        <p id="footer-text"></p>
    </footer>
    <canvas id="animationCanvas"></canvas>
    
    <script>
  document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const currentSection = params.get('section') || '';
      const preloader = document.getElementById('preloader');

      if (currentSection === 'links') {
          if (preloader) preloader.style.display = 'none';
          return;
      }
      if (!preloader) return;

      const canvas = document.getElementById('preloaderCanvas');
      const ctx = canvas.getContext('2d');
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      let W, H, cx, cy;

      function resize() {
          W = window.innerWidth; H = window.innerHeight;
          canvas.width = W * dpr; canvas.height = H * dpr;
          canvas.style.width = W + 'px'; canvas.style.height = H + 'px';
          ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
          cx = W / 2; cy = H / 2;
      }
      resize();
      window.addEventListener('resize', resize);

      const isLight = document.body.classList.contains('light-theme');
      const fg = isLight ? [20, 20, 20] : [255, 255, 255];
      const bg = isLight ? '#f5f5f5' : '#000';
      const dim = isLight ? [100, 100, 100] : [90, 90, 90];
      const accent = isLight ? [80, 80, 80] : [130, 130, 130];

      const TOTAL = 3800;
      const t0 = performance.now();
      let running = true;

      const mobile = W < 768;
      const N = mobile ? 220 : 550;
      const ps = [];
      for (let i = 0; i < N; i++) {
          const a = Math.random() * Math.PI * 2;
          const r = 60 + Math.random() * Math.max(W, H) * 0.55;
          ps.push({
              x: cx + Math.cos(a) * r, y: cy + Math.sin(a) * r,
              r: Math.random() * 1.2 + 0.2,
              a: a, orbitR: r,
              speed: 0.001 + Math.random() * 0.003,
              drift: 0.997 - Math.random() * 0.003,
              alpha: Math.random() * 0.3 + 0.05,
              trail: []
          });
      }

      /* ═══ CONSTELLATION CONNECTIONS ═══ */
      const CONNECTION_DIST = mobile ? 55 : 80;
      const CONN_CHECK = Math.min(N, mobile ? 100 : 180);

      /* ═══ GEOMETRY — ICOSAHEDRON (silver wireframe) ═══ */
      const phi = (1 + Math.sqrt(5)) / 2;
      const icoVerts = [
        [-1, phi, 0],[1, phi, 0],[-1,-phi, 0],[1,-phi, 0],
        [0,-1, phi],[0, 1, phi],[0,-1,-phi],[0, 1,-phi],
        [phi, 0,-1],[phi, 0, 1],[-phi, 0,-1],[-phi, 0, 1]
      ];
      const icoEdges = [
        [0,1],[0,5],[0,7],[0,10],[0,11],[1,5],[1,7],[1,8],[1,9],
        [2,3],[2,4],[2,6],[2,10],[2,11],[3,4],[3,6],[3,8],[3,9],
        [4,5],[4,9],[4,11],[5,9],[5,11],[6,7],[6,8],[6,10],
        [7,8],[7,10],[8,9],[10,11]
      ];
      const icoScale = mobile ? 40 : 60;
      let icoRotX = 0, icoRotY = 0, icoRotZ = 0;

      function project3D(v, rX, rY, rZ) {
          let [x, y, z] = v;
          let c = Math.cos(rY), s = Math.sin(rY);
          let x1 = x * c + z * s, z1 = -x * s + z * c;
          c = Math.cos(rX); s = Math.sin(rX);
          let y1 = y * c - z1 * s, z2 = y * s + z1 * c;
          c = Math.cos(rZ); s = Math.sin(rZ);
          let x2 = x1 * c - y1 * s, y2 = x1 * s + y1 * c;
          const perspective = 400 / (400 + z2 * 20);
          return { x: x2 * icoScale * perspective, y: y2 * icoScale * perspective, z: z2 };
      }

      const ORBIT_DOTS = mobile ? 6 : 10;
      const orbitDots = [];
      for (let i = 0; i < ORBIT_DOTS; i++) {
          orbitDots.push({
              angle: (Math.PI * 2 / ORBIT_DOTS) * i,
              speed: 0.006 + Math.random() * 0.004,
              size: 1 + Math.random() * 1.2
          });
      }

      const letters = ['S', 'R'];

      function frame(now) {
          if (!running) return;
          const elapsed = now - t0;
          const t = Math.min(elapsed / TOTAL, 1);

          ctx.globalAlpha = 1;
          ctx.fillStyle = bg;
          ctx.fillRect(0, 0, W, H);

          const spiralT = Math.min(t / 0.45, 1);
          const convergeT = t > 0.45 ? Math.min((t - 0.45) / 0.2, 1) : 0;
          const revealT = t > 0.65 ? Math.min((t - 0.65) / 0.23, 1) : 0;
          const exitT = t > 0.88 ? Math.min((t - 0.88) / 0.12, 1) : 0;

          const vortexSpeed = 0.012 + spiralT * 0.022;
          const pullStrength = convergeT * 0.07;
          for (const p of ps) {
              p.a += p.speed + vortexSpeed;
              p.orbitR *= p.drift;
              if (convergeT > 0) p.orbitR = p.orbitR * (1 - pullStrength) + 1.5 * pullStrength;
              if (exitT > 0) {
                  const dx = p.x - cx, dy = p.y - cy;
                  const dist = Math.sqrt(dx * dx + dy * dy) || 1;
                  p.x += (dx / dist) * exitT * 18;
                  p.y += (dy / dist) * exitT * 18;
                  p.alpha *= 0.92;
              } else {
                  p.x = cx + Math.cos(p.a) * p.orbitR;
                  p.y = cy + Math.sin(p.a) * p.orbitR;
              }
              p.trail.push({ x: p.x, y: p.y });
              if (p.trail.length > 4) p.trail.shift();
              for (let ti = 0; ti < p.trail.length - 1; ti++) {
                  const ta = p.alpha * (ti / p.trail.length) * 0.2;
                  ctx.beginPath();
                  ctx.moveTo(p.trail[ti].x, p.trail[ti].y);
                  ctx.lineTo(p.trail[ti + 1].x, p.trail[ti + 1].y);
                  ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${ta})`;
                  ctx.lineWidth = p.r * 0.4;
                  ctx.stroke();
              }
              ctx.beginPath();
              ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
              ctx.fillStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${p.alpha})`;
              ctx.fill();
          }

          if (exitT < 0.5) {
              const connAlpha = 0.05 * (1 - exitT * 2) * spiralT;
              const maxDist2 = CONNECTION_DIST * CONNECTION_DIST;
              ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${connAlpha})`;
              ctx.lineWidth = 0.3;
              ctx.beginPath();
              for (let i = 0; i < CONN_CHECK; i++) {
                  for (let j = i + 1; j < CONN_CHECK; j++) {
                      const dx = ps[i].x - ps[j].x;
                      const dy = ps[i].y - ps[j].y;
                      if (dx * dx + dy * dy < maxDist2) {
                          ctx.moveTo(ps[i].x, ps[i].y);
                          ctx.lineTo(ps[j].x, ps[j].y);
                      }
                  }
              }
              ctx.stroke();
          }

          const icoAlpha = spiralT * 0.35 * (1 - exitT);
          if (icoAlpha > 0.01) {
              icoRotX += 0.006; icoRotY += 0.01; icoRotZ += 0.003;
              const breathe = 1 + Math.sin(elapsed * 0.0015) * 0.06;
              const projected = icoVerts.map(v =>
                  project3D([v[0] * breathe, v[1] * breathe, v[2] * breathe], icoRotX, icoRotY, icoRotZ)
              );
              ctx.save();
              ctx.translate(cx, cy);
              ctx.globalAlpha = icoAlpha;
              for (const [a, b] of icoEdges) {
                  const pa = projected[a], pb = projected[b];
                  const depth = Math.min(pa.z, pb.z);
                  const edgeA = 0.1 + (depth + 2) * 0.12;
                  ctx.beginPath();
                  ctx.moveTo(pa.x, pa.y);
                  ctx.lineTo(pb.x, pb.y);
                  ctx.strokeStyle = `rgba(${accent[0]},${accent[1]},${accent[2]},${edgeA})`;
                  ctx.lineWidth = 0.5;
                  ctx.stroke();
              }
              for (const p of projected) {
                  const dotA = 0.2 + (p.z + 2) * 0.15;
                  ctx.beginPath();
                  ctx.arc(p.x, p.y, 1.5, 0, Math.PI * 2);
                  ctx.fillStyle = `rgba(${accent[0]},${accent[1]},${accent[2]},${dotA})`;
                  ctx.fill();
              }
              ctx.restore();
          }

          const orbitAlpha = spiralT * 0.4 * (1 - exitT);
          if (orbitAlpha > 0.01) {
              const baseR = mobile ? 48 : 72;
              const breathe = 1 + Math.sin(elapsed * 0.0018) * 0.08;
              ctx.save();
              ctx.globalAlpha = orbitAlpha;

              ctx.beginPath();
              ctx.arc(cx, cy, baseR * breathe, 0, Math.PI * 2);
              ctx.strokeStyle = `rgba(${dim[0]},${dim[1]},${dim[2]},0.12)`;
              ctx.lineWidth = 0.4;
              ctx.stroke();

              ctx.beginPath();
              ctx.arc(cx, cy, baseR * breathe * 1.45, 0, Math.PI * 2);
              ctx.strokeStyle = `rgba(${dim[0]},${dim[1]},${dim[2]},0.06)`;
              ctx.lineWidth = 0.3;
              ctx.stroke();

              for (const d of orbitDots) {
                  d.angle += d.speed;
                  const r = baseR * breathe;
                  const x = cx + Math.cos(d.angle) * r;
                  const y = cy + Math.sin(d.angle) * r;
                  ctx.beginPath();
                  ctx.arc(x, y, d.size, 0, Math.PI * 2);
                  ctx.fillStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},0.3)`;
                  ctx.fill();
              }
              ctx.restore();
          }

          const glowAlpha = (0.06 + Math.sin(elapsed * 0.003) * 0.03) * (1 - exitT);
          if (glowAlpha > 0.005) {
              const glowR = 35 + spiralT * 25 - convergeT * 15;
              const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, glowR * 2);
              grad.addColorStop(0, `rgba(${fg[0]},${fg[1]},${fg[2]},${glowAlpha})`);
              grad.addColorStop(0.5, `rgba(${fg[0]},${fg[1]},${fg[2]},${glowAlpha * 0.2})`);
              grad.addColorStop(1, 'transparent');
              ctx.beginPath();
              ctx.arc(cx, cy, glowR * 2, 0, Math.PI * 2);
              ctx.fillStyle = grad;
              ctx.fill();
          }

          const arcAlpha = 0.3 * (1 - exitT);
          const arcR = mobile ? 55 : 85;
          if (arcAlpha > 0.01) {
              const progress = 1 - Math.pow(1 - Math.min(t / 0.88, 1), 3);

              ctx.beginPath();
              ctx.arc(cx, cy, arcR, 0, Math.PI * 2);
              ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},0.03)`;
              ctx.lineWidth = 0.8;
              ctx.stroke();

              ctx.beginPath();
              ctx.arc(cx, cy, arcR, -Math.PI / 2, -Math.PI / 2 + progress * Math.PI * 2);
              ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${arcAlpha})`;
              ctx.lineWidth = 1;
              ctx.lineCap = 'round';
              ctx.stroke();

              const tipAngle = -Math.PI / 2 + progress * Math.PI * 2;
              const tipX = cx + Math.cos(tipAngle) * arcR;
              const tipY = cy + Math.sin(tipAngle) * arcR;
              const tipGrad = ctx.createRadialGradient(tipX, tipY, 0, tipX, tipY, 5);
              tipGrad.addColorStop(0, `rgba(${fg[0]},${fg[1]},${fg[2]},${arcAlpha * 0.8})`);
              tipGrad.addColorStop(1, 'transparent');
              ctx.beginPath();
              ctx.arc(tipX, tipY, 5, 0, Math.PI * 2);
              ctx.fillStyle = tipGrad;
              ctx.fill();

              const pct = Math.round(progress * 100);
              ctx.save();
              ctx.globalAlpha = arcAlpha * 0.5;
              ctx.font = `200 ${mobile ? 9 : 10}px 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;
              ctx.textAlign = 'center';
              ctx.textBaseline = 'middle';
              ctx.fillStyle = `rgba(${dim[0]},${dim[1]},${dim[2]},1)`;
              ctx.fillText(`${pct}%`, cx, cy + arcR + (mobile ? 15 : 20));
              ctx.restore();
          }

          if (revealT > 0) {
              const fontSize = mobile ? 56 : 86;
              ctx.save();
              ctx.font = `200 ${fontSize}px 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;
              ctx.textAlign = 'center';
              ctx.textBaseline = 'middle';

              const gap = mobile ? 22 : 36;
              const widths = letters.map(ch => ctx.measureText(ch).width);
              const totalW = widths[0] + gap + widths[1];
              const positions = [
                  cx - totalW / 2 + widths[0] / 2,
                  cx + totalW / 2 - widths[1] / 2
              ];

              letters.forEach((ch, i) => {
                  const charT = Math.max(0, Math.min(1, (revealT - i * 0.18) / 0.5));
                  const eased = 1 - Math.pow(1 - charT, 5);
                  if (eased < 0.01) return;

                  const charX = positions[i];
                  const charY = cy;
                  const a = eased * (1 - exitT);

                  ctx.globalAlpha = a * 0.1;
                  ctx.filter = 'blur(20px)';
                  ctx.fillStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},1)`;
                  ctx.fillText(ch, charX, charY);
                  ctx.filter = 'none';

                  ctx.globalAlpha = a * 0.2;
                  ctx.filter = 'blur(6px)';
                  ctx.fillText(ch, charX, charY);
                  ctx.filter = 'none';

                  ctx.globalAlpha = a * 0.85;
                  ctx.fillStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},1)`;
                  ctx.fillText(ch, charX, charY);
              });

              const lineProgress = Math.min(1, revealT / 0.5);
              const lineEased = 1 - Math.pow(1 - lineProgress, 3);
              const lineA = lineEased * 0.18 * (1 - exitT);
              if (lineA > 0.005) {
                  const lineH = fontSize * 0.38 * lineEased;
                  ctx.globalAlpha = lineA;
                  ctx.beginPath();
                  ctx.moveTo(cx, cy - lineH);
                  ctx.lineTo(cx, cy + lineH);
                  ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},1)`;
                  ctx.lineWidth = 0.5;
                  ctx.stroke();
              }
              ctx.restore();

              const ruleT = Math.max(0, (revealT - 0.25) / 0.5);
              const ruleEased = 1 - Math.pow(1 - Math.min(ruleT, 1), 3);
              const ruleA = ruleEased * 0.12 * (1 - exitT);
              if (ruleA > 0.005) {
                  const ruleW = (mobile ? 70 : 120) * ruleEased;
                  ctx.save();
                  ctx.globalAlpha = ruleA;
                  const ruleGrad = ctx.createLinearGradient(cx - ruleW, 0, cx + ruleW, 0);
                  ruleGrad.addColorStop(0, 'transparent');
                  ruleGrad.addColorStop(0.2, `rgba(${dim[0]},${dim[1]},${dim[2]},1)`);
                  ruleGrad.addColorStop(0.8, `rgba(${dim[0]},${dim[1]},${dim[2]},1)`);
                  ruleGrad.addColorStop(1, 'transparent');
                  ctx.beginPath();
                  ctx.moveTo(cx - ruleW, cy + fontSize * 0.48);
                  ctx.lineTo(cx + ruleW, cy + fontSize * 0.48);
                  ctx.strokeStyle = ruleGrad;
                  ctx.lineWidth = 0.5;
                  ctx.stroke();
                  ctx.restore();
              }

              const subT = Math.max(0, (revealT - 0.4) / 0.6);
              const subEased = 1 - Math.pow(1 - Math.min(subT, 1), 4);
              const subA = subEased * 0.2 * (1 - exitT);
              if (subA > 0.01) {
                  ctx.save();
                  ctx.globalAlpha = subA;
                  ctx.font = `300 ${mobile ? 8 : 10}px 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;
                  ctx.textAlign = 'center';
                  ctx.textBaseline = 'middle';
                  ctx.fillStyle = `rgba(${dim[0]},${dim[1]},${dim[2]},1)`;
                  ctx.fillText('S U R Y A N A R A Y A N   R E N J I T H', cx, cy + fontSize * 0.48 + (mobile ? 14 : 20));
                  ctx.restore();
              }
          }

          if (exitT > 0) {
              const ringR = exitT * Math.max(W, H) * 0.5;
              const ringA = (1 - exitT) * 0.2;
              if (ringA > 0.01) {
                  ctx.beginPath();
                  ctx.arc(cx, cy, ringR, 0, Math.PI * 2);
                  ctx.strokeStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${ringA})`;
                  ctx.lineWidth = 0.8 + exitT * 2;
                  ctx.stroke();
              }
              if (exitT > 0.35) {
                  const fadeA = Math.pow((exitT - 0.35) / 0.65, 1.5);
                  ctx.globalAlpha = fadeA;
                  ctx.fillStyle = bg;
                  ctx.fillRect(0, 0, W, H);
              }
          }

          if (exitT < 0.3 && !mobile) {
              ctx.globalAlpha = 0.012;
              for (let sy = 0; sy < H; sy += 4) {
                  if (Math.random() > 0.75) {
                      ctx.fillStyle = `rgba(${fg[0]},${fg[1]},${fg[2]},${Math.random() * 0.02})`;
                      ctx.fillRect(0, sy, W, 1);
                  }
              }
          }

          if (t >= 1) {
              running = false;
              preloader.style.display = 'none';
              document.body.classList.add('loaded');
              return;
          }
          requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
  });
</script>

    <script>
    function isWebGLAvailable() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                return !!(gl && gl instanceof WebGLRenderingContext);
            } catch (e) {
                return false;
            }
        }

    function fallbackToCanvasAnimation() {

    document.body.style.cursor = 'crosshair';

    const isLightInit = document.body.classList.contains('light-theme');
    let starR = isLightInit ? 30 : 255;
    let starG = isLightInit ? 30 : 255;
    let starB = isLightInit ? 30 : 255;
    window.addEventListener('themeChanged', (e) => {
        if (e.detail && e.detail.light) {
            starR = 30; starG = 30; starB = 30;
        } else {
            starR = 255; starG = 255; starB = 255;
        }
    });
    
    const canvas = document.getElementById('animationCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    const stars = [];
    const minStars = 250;
    const maxStars = 500;
    const edgeThreshold = 10;

    function createStar() {
        const speed = Math.random() * 0.5 + 0.1;
        return {
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 3,
            speed: speed,
            alpha: Math.random(),
            phase: Math.random() * 2 * Math.PI,
            dx: (Math.random() - 0.5) * speed,
            dy: (Math.random() - 0.5) * speed,
            tiltFactor: Math.random() * 0.05 + 0.05,
            trail: []
        };
    }

    function removeOffScreenStars() {
        for (let i = stars.length - 1; i >= 0; i--) {
            const star = stars[i];
            if (star.x < -edgeThreshold || star.x > canvas.width + edgeThreshold ||
                star.y < -edgeThreshold || star.y > canvas.height + edgeThreshold) {
                stars.splice(i, 1);
            }
        }
    }

    for (let i = 0; i < minStars; i++) {
        stars.push(createStar());
    }

    let mouseX = canvas.width / 2;
    let mouseY = canvas.height / 2;
    const avoidanceRadius = 100;
    let lastMouseMoveTime = Date.now();
    const mouseInactiveThreshold = 3000;

    canvas.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        lastMouseMoveTime = Date.now();
    });

    let tiltX = 0;

    window.addEventListener('deviceorientation', (e) => {
        tiltX = e.gamma;
    });

    function deflectStar(star1, star2) {
        const angle = Math.random() * 2 * Math.PI;
        const speed = Math.random() * 0.5 + 0.1;
        star1.dx = Math.cos(angle) * speed;
        star1.dy = Math.sin(angle) * speed;
        star2.dx = -Math.cos(angle) * speed;
        star2.dy = -Math.sin(angle) * speed;
    }

    function applyAI(star) {
        const now = Date.now();
        const mouseInactive = now - lastMouseMoveTime > mouseInactiveThreshold;

        if (!mouseInactive) {
            const dx = star.x - mouseX;
            const dy = star.y - mouseY;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance < avoidanceRadius) {
                const angle = Math.atan2(dy, dx) + (Math.random() - 0.5) * Math.PI;
                const speedFactor = (avoidanceRadius - distance) / avoidanceRadius;
                star.dx = Math.cos(angle) * speedFactor * star.speed;
                star.dy = Math.sin(angle) * speedFactor * star.speed;
            } else {
                star.dx += (Math.random() - 0.5) * 0.1;
                star.dy += (Math.random() - 0.5) * 0.1;
            }
        } else {
            star.dx += (Math.random() - 0.5) * 0.1;
            star.dy += (Math.random() - 0.5) * 0.1;
        }

        star.x += star.dx;
        star.y += star.dy;

        star.x += tiltX * star.tiltFactor;

        if (star.x < edgeThreshold) star.dx += (edgeThreshold - star.x) / edgeThreshold * 0.05;
        if (star.x > canvas.width - edgeThreshold) star.dx -= (star.x - (canvas.width - edgeThreshold)) / edgeThreshold * 0.05;
        if (star.y < edgeThreshold) star.dy += (edgeThreshold - star.y) / edgeThreshold * 0.05;
        if (star.y > canvas.height - edgeThreshold) star.dy -= (star.y - (canvas.height - edgeThreshold)) / edgeThreshold * 0.05;

        if (star.x < 0) star.x = 0;
        if (star.x > canvas.width) star.x = canvas.width;
        if (star.y < 0) star.y = 0;
        if (star.y > canvas.height) star.y = canvas.height;

        star.alpha = 0.5 + Math.cos(star.phase) * 0.5;
        star.phase += star.speed * 0.05;

        if (star.trail.length > 10) star.trail.shift();
        star.trail.push({ x: star.x, y: star.y, alpha: star.alpha });
    }

    function handleCollisions() {
        for (let i = 0; i < stars.length; i++) {
            for (let j = i + 1; j < stars.length; j++) {
                const star1 = stars[i];
                const star2 = stars[j];
                const dx = star1.x - star2.x;
                const dy = star1.y - star2.y;
                const distSq = dx * dx + dy * dy;
                const minDist = star1.radius + star2.radius;

                if (distSq < minDist * minDist) {
                    deflectStar(star1, star2);
                }
            }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        while (stars.length < minStars) {
            stars.push(createStar());
        }

        while (stars.length > maxStars) {
            stars.pop();
        }

        const len = stars.length;
        for (let i = 0; i < len; i++) {
            const star = stars[i];
            applyAI(star);

            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, 6.2832, false);
            ctx.fillStyle = `rgba(${starR}, ${starG}, ${starB}, ${star.alpha})`;
            ctx.fill();

            const tLen = star.trail.length;
            for (let j = 0; j < tLen; j++) {
                const t = star.trail[j];
                const trailAlpha = t.alpha * (1 - j / tLen);
                const trailRadius = star.radius * (1 - j / tLen);
                ctx.beginPath();
                ctx.arc(t.x, t.y, trailRadius, 0, 6.2832, false);
                ctx.fillStyle = `rgba(${starR}, ${starG}, ${starB}, ${trailAlpha})`;
                ctx.fill();
            }
        }

        handleCollisions();
        removeOffScreenStars();
        requestAnimationFrame(draw);
    }

    draw();
}

function isOldBrowser() {
    const userAgent = navigator.userAgent;

    const oldBrowserRegex = /MSIE|Trident|Edge\/\d{1,2}\./; 
            const oldSafariRegex = /Version\/[1-9]\.\d Safari\//; 
            const oldFirefoxRegex = /Firefox\/[1-9][0-9]?\./; 
            const oldChromeRegex = /Chrome\/[1-5]\d\./;
            const oldOperaRegex = /Opera\/[1-9]\d\./;
            const oldAndroidRegex = /Android [1-4]\./;
            const oldiOSRegex = /CPU iPhone OS [1-9]_/;

    return oldBrowserRegex.test(userAgent) || oldSafariRegex.test(userAgent);
}

    if (!isWebGLAvailable() || isOldBrowser()) {
        console.log("WebGL is not supported or the browser is outdated. Switching to fallback animation.");
        document.querySelectorAll(".cursor-dot, .cursor-dot-outline").forEach(element => {
            element.remove();
        });
         fallbackToCanvasAnimation();
    }
    </script>
    
    <script type="module" src="script.js"></script>

<div id="sunrise-overlay"></div>

<script>
(function() {
    const LIGHT_SEQUENCE = ['KeyS','KeyU','KeyR','KeyY','KeyA'];
    let lightBuffer = [];

    function toggleLightTheme() {
        const isLight = document.body.classList.toggle('light-theme');
        const overlay = document.getElementById('sunrise-overlay');

        if (isLight) {
            sessionStorage.setItem('suryaLightTheme', 'true');
        } else {
            sessionStorage.removeItem('suryaLightTheme');
        }

        document.body.classList.add('theme-transitioning');

        if (overlay) {
            overlay.classList.remove('active', 'reverse');
            void overlay.offsetWidth;
            if (!isLight) overlay.classList.add('reverse');
            overlay.classList.add('active');
            setTimeout(() => {
                overlay.classList.remove('active', 'reverse');
            }, 1100);
        }

        setTimeout(() => {
            document.body.classList.remove('theme-transitioning');
        }, 700);

        window.dispatchEvent(new CustomEvent('themeChanged', {
            detail: { light: isLight }
        }));
    }

    if (window.__lightThemeOnLoad) {
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                window.dispatchEvent(new CustomEvent('themeChanged', {
                    detail: { light: true }
                }));
            }, 100);
        });
    }

    window.addEventListener('keydown', (e) => {
        if (e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) return;

        lightBuffer.push(e.code);

        if (lightBuffer.length > LIGHT_SEQUENCE.length) {
            lightBuffer.shift();
        }

        if (
            lightBuffer.length === LIGHT_SEQUENCE.length &&
            LIGHT_SEQUENCE.every((code, idx) => lightBuffer[idx] === code)
        ) {
            toggleLightTheme();
            lightBuffer = [];
        }
    });
})();
</script>

</body>
</html>
