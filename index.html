<!--@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@                    ,@@@@@@@@@@@@@@@                         ,@@@@@@@@@@
    @@@@.                          %@@@@@@@@@@@                              *@@@@@@
    @@,                             @@@@@@@@@@                                 &@@@@
    @.            &@@@@@@@@         @@@@@@@@@@            @@@@@@@@@             %@@@
    @           (@@@@@@@@@@@@@@@(((@@@@@@@@@@@           @@@@@@@@@@@@            @@@
    @           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@#           @@@
    @             @@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@,           @@@
    @@                 @@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@@@@           @@@@
    @@@                      *@@@@@@@@@@@@@@@@           @@@@@@@@@             @@@@@
    @@@@@@                        @@@@@@@@@@@@           @@@                @@@@@@@@
    @@@@@@@@@@                      @@@@@@@@@@           @&             @@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@                @@@@@@@@@           @@@&              @@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@             @@@@@@@@           @@@@@@,             @@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@.           @@@@@@@@           @@@@@@@@@             @@@@@
    @/      @@@@@@@@@@@@@@            @@@@@@@@           @@@@@@@@@@@             @@@
               @@@@@@@@@             @@@@@@@@@           @@@@@@@@@@@@*            @@
    @                               @@@@@@@@@@           @@@@@@@@@@@@@@            @
    @@                            @@@@@@@@@@@@           @@@@@@@@@@@@@@@            
    @@@@@                     %@@@@@@@@@@@@@@@           @@@@@@@@@@@@@@@@           
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Surya Website" />
    <meta property="og:description" content="Fusing Imagination with Innovation." />
    <meta property="og:image" content="https://surya.is-a.dev/assets/bg.png" />
    <meta property="og:url" content="https://surya.is-a.dev/" />
    <meta property="og:type" content="website" />
    <script src="/blocker.js"></script>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "WebPage",
          "name": "Surya Website",
          "description": "Fusing Imagination with Innovation.",
          "url": "https://surya.is-a.dev/",
          "image": "https://surya.is-a.dev/assets/bg.png"
        }
    </script>
     <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0QSEZ9VSPZ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0QSEZ9VSPZ');
    </script> 
    <title>Suryanarayan Renjith</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <script>
  (async function verifyAndProceed() {
    function getFingerprint() {
      return `${navigator.userAgent}-${screen.width}-${screen.height}-${navigator.language}-${window.devicePixelRatio}`;
    }
    
    const now = Date.now();
    const lastRefresh = localStorage.getItem('lastRefresh');
    let suspicious = false;
    
    if (lastRefresh && (now - parseInt(lastRefresh, 10) < 2000)) {
      suspicious = true;
    }
    localStorage.setItem('lastRefresh', now);
    
    try {
      const response = await fetch('https://surya-verify.vercel.app/api/verify-user', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          fingerprint: getFingerprint(),
          suspicious: suspicious
        })
      });
      
      const data = await response.json();

      if (data.suspicious === true || !data.verified) {
        window.location.href = '/404';
        return;
      }
      
      console.log('User verified. Proceeding to the site...');
    } catch (error) {
      console.error('Error verifying user');
    }
  })();
        
(async function() {
    function block() {
      window.location.href = '/policy.html';
    }

    try {
      const res = await fetch('https://surya-verify.vercel.app/api/verify-proxy', {
        method: 'GET',
        mode: 'cors',
        credentials: 'omit'
      });

      if (!res.ok) return block();

      const data = await res.json();
      if (typeof data !== 'boolean') return block();

      if (data) return block();

    } catch (err) {
      console.error('Proxy check error');
      block();
    }
  })(); 
</script>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const fullText = "Suryanarayan Renjith";
        const fixedChar = "S";
        const dynamicText = fullText.slice(1);
        let index = 0;
        let isDeleting = false;
    
        function type() {
            const speed = 300;
    
            if (isDeleting) {
                document.title = fixedChar + dynamicText.substring(0, index - 1);
                index--;
                if (index === 0) {
                    isDeleting = false;
                }
            } else {
                document.title = fixedChar + dynamicText.substring(0, index + 1);
                index++;
                if (index === dynamicText.length) {
                    isDeleting = true;
                }
            }
    
            setTimeout(type, speed);
        }
    
        type();
});
    </script>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="assets/favicon/site.webmanifest">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<style>
#fa-test {
    position: absolute;
    visibility: hidden;
        }
</style>

<i id="fa-test" class="fa-solid fa-circle-exclamation"></i>

<script>
    function isFontAwesomeLoaded() {
    const testIcon = document.getElementById('fa-test');
    const iconWidth = window.getComputedStyle(testIcon).width;   
    if (!iconWidth || parseFloat(iconWidth) === 0) {
        alert("Font Awesome icons are not loading correctly. Please whitelist the Font Awesome CDN in your ad blocker settings to ensure proper icon display.");
    }
}
window.onload = isFontAwesomeLoaded;
</script>

<script>
function isDesktop() {
    return window.innerWidth > 768 && !("ontouchstart" in window || navigator.maxTouchPoints > 0);
  }

  function initializeCursor() {
    const cursorDot = document.createElement("div");
    cursorDot.classList.add("cursor-dot");
    document.body.appendChild(cursorDot);

    const cursorOutline = document.createElement("div");
    cursorOutline.classList.add("cursor-dot-outline");
    document.body.appendChild(cursorOutline);

    let mouseX = 0;
    let mouseY = 0;
    let outlineX = 0;
    let outlineY = 0;
    let dotX = 0;
    let dotY = 0;

    document.addEventListener("mousemove", (e) => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    function animateCursor() {
      outlineX += (mouseX - outlineX) * 0.15;
      outlineY += (mouseY - outlineY) * 0.15;

      dotX += (mouseX - dotX) * 0.1;
      dotY += (mouseY - dotY) * 0.1;

      cursorOutline.style.left = `${outlineX}px`;
      cursorOutline.style.top = `${outlineY}px`;
      cursorDot.style.left = `${dotX}px`;
      cursorDot.style.top = `${dotY}px`;

      requestAnimationFrame(animateCursor);
    }

    animateCursor();

    const addCursorHoverEffect = () => {
      document.body.classList.add("cursor-hover");
    };

    const removeCursorHoverEffect = () => {
      document.body.classList.remove("cursor-hover");
    };

    document.querySelectorAll("a, button, .hover-target").forEach((el) => {
      el.addEventListener("mouseenter", addCursorHoverEffect);
      el.addEventListener("mouseleave", removeCursorHoverEffect);
    });
  }

  if (isDesktop()) {
    initializeCursor();
  }
      </script>
    
    <header>
        <nav class="menu-bar">
            <ul>
                <li><a href="#" data-section="home">Home</a></li>
                <li><a href="#" data-section="about">About</a></li>
                <li><a href="#" data-section="projects">Projects</a></li>
                <li><a href="#" data-section="resume">Resume</a></li>
                <li class="music-button-container" id="buttonhide">
                    <button class="music-button" id="unmuteButton" aria-label="Toggle Music">
                        <i class="fas fa-volume-mute"></i>
                    </button>
                    <button class="music-button hidden" id="muteButton" aria-label="Toggle Music">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </header>

    <div class="progress-bar"><div></div></div>

    <div id="keyboard-popups">
            <button class="help-button" id="helpButton">
                <i class="fa-solid fa-info"></i>
            </button>
            <div class="modal-overlay" id="modalOverlay"></div>
            <div class="shortcuts-modal" id="shortcutsModal">
                <button class="close-modal" id="closeModal">&times;</button>
                <div class="modal-container">
                    <div class="modal-tabs">
                        <button class="tab-button active" data-tab="about">About</button>
                        <button class="tab-button" data-tab="keyboard">Keyboard</button>
                        <button class="tab-button" data-tab="terminal">Terminal</button>
                        <button class="tab-button" data-tab="client">Client</button>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="about-tab">
                            <div class="about-section">
                                <div class="favicon-container">
                                    <img src="/assets/favicon/android-chrome-512x512.png" alt="Favicon" class="favicon" />
                                </div>
                                <h3 class="website-title">Surya Website</h3>
                                <p id="yearRange">
                                    <i class="fa-regular fa-calendar"></i>
                                    Since 2023
                                </p>                                  
                                <p id="uptimeResponseTime" class="uptime-response-time">Loading…</p>
                                <p class="made-with">Made with <span class="heart"> <i class="fa-solid fa-heart"></i> </span> by Suryanarayan Renjith.</p>
                            </div>
                        </div>
                        <div class="tab-pane" id="keyboard-tab">
                            <ul class="shortcuts-list">
                                <li><span class="shortcut-key">Ctrl + Shift + /</span> Open Info Section</li>
                                <li><span class="shortcut-key">Ctrl + Shift + 5</span> Go to Home section</li>
                                <li><span class="shortcut-key">Ctrl + Shift + 6</span> Go to About section</li>
                                <li><span class="shortcut-key">Ctrl + Shift + 7</span> Go to Projects section</li>
                                <li><span class="shortcut-key">Ctrl + Shift + 8</span> Go to Resume section</li>
                                <li><span class="shortcut-key">Ctrl + Shift + K</span> Open Terminal in new tab</li>
                                <li><span class="shortcut-key">Ctrl + Shift + L</span> Open Links in the same tab</li>
                                <li><span class="shortcut-key">Ctrl + Shift + V</span> Open Resume in new tab</li>
                            </ul>
                        </div>
                        <div class="tab-pane" id="terminal-tab">
                            <div class="terminal-info">
                                <p>Access the terminal to run commands and interact with this portfolio directly.</p>
                                <button class="action-button" id="openTerminal">
                                    <i class="fa-solid fa-terminal"></i> Open Terminal
                                </button>
                                <div class="terminal-logs">
                                    <code></code>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="client-tab">
                            <div class="client-info">
                                <p>Download my portfolio client to access my portfolio anytime with ease.</p>
                                <button class="action-button" id="downloadClient">
                                    <i class="fa-solid fa-download"></i> Download Client
                                </button>
                                <div class="client-logs">
                                    <code></code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', () => {
              const styleFix = document.createElement('style');
              styleFix.textContent = `
              *, *::before, *::after { -webkit-tap-highlight-color: transparent; }
              button, a, .tab-button, .shortcut-key, .shortcuts-list li { outline: none; }`;
              document.head.appendChild(styleFix);
                
              const keyValue     = 'uptimeResponseTime';
              const keyTimestamp = 'uptimeResponseTimeTimestamp';
              const now          = Date.now();
              const dayMs        = 24 * 60 * 60 * 1000;
          
              const el = document.getElementById('uptimeResponseTime');
              function setUI(val) {
                if (el) el.textContent = `Last checked response time: ${val}`;
              }
          
              const cachedVal = localStorage.getItem(keyValue);
              const cachedTs  = parseInt(localStorage.getItem(keyTimestamp), 10);
              if (cachedVal && cachedTs && (now - cachedTs < dayMs)) {
                setUI(cachedVal);
              } else {
                fetch('https://uptime.surya-ops.workers.dev/')
                  .then(res => res.json())
                  .then(data => {
                    const rt = data.responseTime;
                    setUI(rt);
                    localStorage.setItem(keyValue, rt);
                    localStorage.setItem(keyTimestamp, now.toString());
                  })
                  .catch(() => {
                    setUI('--');
                  });
              }
          
              const header = document.querySelector('header');
              const helpButton        = document.getElementById('helpButton');
              const modalOverlay      = document.getElementById('modalOverlay');
              const shortcutsModal    = document.getElementById('shortcutsModal');
              const closeModal        = document.getElementById('closeModal');
              const openTerminalBtn   = document.getElementById('openTerminal');
              const downloadClientBtn = document.getElementById('downloadClient');
              const tabButtons        = document.querySelectorAll('.tab-button');
              const aboutBtn          = document.querySelector('.tab-button[data-tab="about"]');
              const keyboardBtn       = document.querySelector('.tab-button[data-tab="keyboard"]');
              const terminalTabBtn    = document.querySelector('.tab-button[data-tab="terminal"]');
              const clientBtn         = document.querySelector('.tab-button[data-tab="client"]');
          
              const ua                = navigator.userAgent.toLowerCase();
              const isWindowsClient   = /windows nt|win64|wow64/i.test(ua);
              const isAndroidClient   = /android/i.test(ua);
              const isMobileClient    = /mobile|tablet|iphone|ipad|ipod/i.test(ua);
              const isElectron        = ua.includes('electron');
              const isAndroidWebView  = /; wv\)/.test(navigator.userAgent);

              if (isElectron || isAndroidWebView) {
                document.querySelector('.tab-button[data-tab="client"]')?.remove();
                document.getElementById('client-tab')?.remove();
               }
          
              let shortcutsVisible = false;
              const showShortcuts = () => {
                modalOverlay.classList.add('active');
                shortcutsModal.style.display = 'block';
                shortcutsVisible = true;
                header.style.setProperty('display', 'none', 'important');
              };
              const hideShortcuts = () => {
                modalOverlay.classList.remove('active');
                shortcutsModal.style.display = 'none';
                shortcutsVisible = false;
                header.style.removeProperty('display', 'important');
              };
              const toggleShortcuts = () => {
                shortcutsVisible ? hideShortcuts() : showShortcuts();
              };
          
              helpButton.addEventListener('click', toggleShortcuts);
              closeModal.addEventListener('click', hideShortcuts);
              modalOverlay.addEventListener('click', e => {
                if (e.target === modalOverlay && shortcutsVisible) hideShortcuts();
              });
          
              const launchTerminal = () => {
                const terminalLogs = document.querySelector('.terminal-logs code');
                try {
                  const now = new Date().toLocaleTimeString();
                  terminalLogs.textContent = `${now}: Opening terminal...`;
          
                  const link = document.createElement('a');
                  link.href   = '/Cli';
                  link.target = '_blank';
                  link.rel    = 'noopener noreferrer';
                  link.style.display = 'none';
                  document.body.appendChild(link);
                  link.click();
                  link.remove();
          
                  terminalLogs.textContent += `\n${new Date().toLocaleTimeString()}: Terminal session started. Type 'help' for available commands.`;
                } catch (err) {
                  const errorTime = new Date().toLocaleTimeString();
                  terminalLogs.textContent += `\n${errorTime}: Failed to open terminal ("${err.message}").`;
                }
              };
          
              const downloadInstaller = (force = false) => {
              const clientLogs = document.querySelector('.client-logs code');
              const ua         = navigator.userAgent || '';
            
              const isWindowsClient = /windows nt|win64|wow64/i.test(ua);
              const isAndroidClient = /android/i.test(ua);
              const isMobileClient  = /mobile|tablet|iphone|ipad|ipod/i.test(ua);
              const isLinuxClient   = /linux/i.test(ua) && !isAndroidClient && !isWindowsClient && !isMobileClient;
            
              const wantApk        = isAndroidClient || (isMobileClient && !isWindowsClient);
              const wantAppImage   = isLinuxClient;
              const wantExe        = isWindowsClient;
              const canDownload    = wantApk || wantAppImage || wantExe;
            
              if (!canDownload && !force) {
                clientLogs.textContent = `${new Date().toLocaleTimeString()}: This installer is built for Windows, Linux and Android only. If you'd still like to download the file, click below.`;
                clientLogs.innerHTML += `\n<a href="#" id="forceDownloadLink" style="color:white;">Download .exe anyway...</a>`;
                document.getElementById('forceDownloadLink')?.addEventListener('click', e => {
                  e.preventDefault();
                  downloadInstaller(true);
                });
                return;
              }
            
              clientLogs.textContent = `${new Date().toLocaleTimeString()}: Connecting to download server...`;
            
              const params = [];
              if (wantApk)  params.push('apk=true');
              if (force)    params.push('force=true');
              const endpoint = `https://surya-verify.vercel.app/api/installer${params.length ? '?' + params.join('&') : ''}`;
            
              fetch(endpoint)
                .then(async response => {
                  const ct = response.headers.get('Content-Type') || '';
                  if (ct.includes('application/json')) {
                    const json = await response.json();
                    const t    = new Date().toLocaleTimeString();
                    const msg  = json.message || json.error || 'Unknown response';
                    clientLogs.textContent += `\n${t}: ${msg}`;
                    if (json.forceUrl) {
                      clientLogs.innerHTML += `\n<a href="#" id="forceDownloadLink2" style="color:white;">Download anyway...</a>`;
                      document.getElementById('forceDownloadLink2')?.addEventListener('click', e => {
                        e.preventDefault();
                        window.location.href = json.forceUrl;
                      });
                    }
                    throw new Error('handled-json');
                  }
                  if (!response.ok) {
                    throw new Error(`Server responded with ${response.status}`);
                  }
            
                      const disposition = response.headers.get('Content-Disposition') || '';
                      const m           = disposition.match(/filename="?([^";]+)"?/i);
                      const fileName    = m
                        ? m[1]
                        : wantApk
                          ? 'SuryaWebsiteApp.apk'
                          : wantAppImage
                            ? 'SuryaWebsiteApp.AppImage'
                            : 'SuryaWebsiteApp.exe';
                
                      const blob = await response.blob();
                      clientLogs.textContent += `\n${new Date().toLocaleTimeString()}: Fetching "${fileName}"...`;
                
                      const url = URL.createObjectURL(blob);
                      const a   = document.createElement('a');
                      a.href     = url;
                      a.download = fileName;
                      document.body.appendChild(a);
                      a.click();
                      a.remove();
                      URL.revokeObjectURL(url);
                
                      clientLogs.textContent += `\n${new Date().toLocaleTimeString()}: "${fileName}" fetched successfully.`;
                    })
                    .catch(err => {
                      if (err.message === 'handled-json') return;
                      const t = new Date().toLocaleTimeString();
                      clientLogs.textContent += `\n${t}: Download failed ("${err.message}"). Please try again later.`;
                    });
                };
                
                tabButtons.forEach(btn => {
                  btn.addEventListener('click', () => {
                    tabButtons.forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(`${btn.dataset.tab}-tab`)?.classList.add('active');
                  });
                });
                openTerminalBtn?.addEventListener('click', launchTerminal);
                downloadClientBtn?.addEventListener('click', () => downloadInstaller(false));

          
              document.querySelectorAll('.shortcuts-list li').forEach(li => {
                const key = li.querySelector('.shortcut-key')?.textContent.trim();
                if (!key) return;
                li.style.cursor = 'pointer';
                li.addEventListener('click', () => {
                  switch (key) {
                    case 'Ctrl + Shift + /':
                      toggleShortcuts();
                      break;
                    case 'Ctrl + Shift + 5':
                      showContent?.('home'); updateProgressBar?.('home');
                      break;
                    case 'Ctrl + Shift + 6':
                      showContent?.('about'); updateProgressBar?.('about');
                      break;
                    case 'Ctrl + Shift + 7':
                      showContent?.('projects'); updateProgressBar?.('projects');
                      break;
                    case 'Ctrl + Shift + 8':
                      showContent?.('resume'); updateProgressBar?.('resume');
                      break;
                    case 'Ctrl + Shift + K':
                      launchTerminal();
                      break;
                    case 'Ctrl + Shift + L':
                      setTimeout(() => window.open('/?section=links','_self'), 100);
                      break;
                    case 'Ctrl + Shift + V':
                      setTimeout(() => window.open('/Resume','_blank'), 100);
                      break;
                  }
                });
              });
          
              document.addEventListener('keydown', event => {
                if (shortcutsVisible && !event.ctrlKey && !event.shiftKey) {
                    switch (event.key.toLowerCase()) {
                      case 'a': aboutBtn?.click();      break;
                      case 'k': keyboardBtn?.click();   break;
                      case 't': terminalTabBtn?.click();break;
                      case 'c': if (clientBtn && !isElectron) clientBtn.click(); break;
                    }
                  }
                if (event.ctrlKey && event.shiftKey) {
                  if (['Slash','/','?'].includes(event.key) || event.code === 'Slash') {
                    event.preventDefault();
                    toggleShortcuts();
                    return;
                  }
                  switch (event.code) {
                    case 'Digit5': event.preventDefault(); showContent?.('home'); updateProgressBar?.('home'); break;
                    case 'Digit6': event.preventDefault(); showContent?.('about'); updateProgressBar?.('about'); break;
                    case 'Digit7': event.preventDefault(); showContent?.('projects'); updateProgressBar?.('projects'); break;
                    case 'Digit8': event.preventDefault(); showContent?.('resume'); updateProgressBar?.('resume'); break;
                    case 'KeyK':   event.preventDefault(); launchTerminal(); break;
                    case 'KeyL':   event.preventDefault(); setTimeout(()=>window.open('/?section=links','_self'),100); break;
                    case 'KeyV':   event.preventDefault(); setTimeout(()=>window.open('/Resume','_blank'),100); break;
                  }
                }
              });
            });
          </script>
    
    <noscript>
        <div class="offline-message" style="display: block;">
            Please enable JavaScript to use this website.
        </div>
    </noscript>

    <style>
    .offline-message {
            display: none;
            position: fixed;
            top: 20%;
            left: 0;
            width: 100%;
            background-color: black;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 18px;
            z-index: 1000;
        }

        @media only screen and (max-width: 600px) {
            .offline-message {
                font-size: 14px;
                padding: 10px;
            }
        }

        @media only screen and (min-width: 601px) and (max-width: 1024px) {
            .offline-message {
                font-size: 16px;
            }
        }
</style>

    <script>   
        const CLOUD_FLARE_WORKER_URL = 'https://pages.surya-ops.workers.dev/';
        
        let isMobile = /Mobi|Android/i.test(navigator.userAgent);
        
        function addAnimationStyles() {
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes slideUp {
                    0% { transform: translateY(100%) scale(0.8); opacity: 0; }
                    100% { transform: translateY(0) scale(1); opacity: 1; }
                }
                @keyframes slideDown {
                    0% { transform: translateY(-100%) scale(0.8); opacity: 0; }
                    100% { transform: translateY(0) scale(1); opacity: 1; }
                }
                @keyframes mobileRotateX90 {
                    0% { transform: perspective(1000px) rotateX(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateX(90deg) scale(0.5); opacity: 0; }
                }
                @keyframes mobileRotateXNeg90 {
                    0% { transform: perspective(1000px) rotateX(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateX(-90deg) scale(0.5); opacity: 0; }
                }
                @keyframes mobileRotateY180 {
                    0% { transform: perspective(1000px) rotateY(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateY(180deg) scale(0.5); opacity: 0; }
                }
                @keyframes mobileRotateYNeg180 {
                    0% { transform: perspective(1000px) rotateY(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateY(-180deg) scale(0.5); opacity: 0; }
                }
                @keyframes desktopRotateY90 {
                    0% { transform: perspective(1000px) rotateY(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateY(90deg) scale(0.8); opacity: 0; }
                }
                @keyframes desktopRotateYNeg90 {
                    0% { transform: perspective(1000px) rotateY(0) scale(1); opacity: 1; }
                    100% { transform: perspective(1000px) rotateY(-90deg) scale(0.8); opacity: 0; }
                }
                .slide-up { animation: slideUp 1s ease-in-out forwards; }
                .slide-down { animation: slideDown 1s ease-in-out forwards; }
                .mobile-rotate-x-90 { animation: mobileRotateX90 1s ease-in-out forwards; }
                .mobile-rotate-x-neg-90 { animation: mobileRotateXNeg90 1s ease-in-out forwards; }
                .mobile-rotate-y-180 { animation: mobileRotateY180 1s ease-in-out forwards; }
                .mobile-rotate-y-neg-180 { animation: mobileRotateYNeg180 1s ease-in-out forwards; }
                .desktop-rotate-y-90 { animation: desktopRotateY90 1s ease-in-out forwards; }
                .desktop-rotate-y-neg-90 { animation: desktopRotateYNeg90 1s ease-in-out forwards; }
            `;
            document.head.appendChild(style);
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams       = new URLSearchParams(window.location.search);
            const sectionFromQuery = urlParams.get('section');
            const sectionFromHash  = window.location.hash.substring(1);
            const sectionFromStorage = sessionStorage.getItem('lastSection');
            const sectionToLoad = sectionFromQuery
                                || sectionFromHash
                                || sectionFromStorage
                                || 'home';
            currentSectionIndex = sectionOrder.indexOf(sectionToLoad);
            showContent(sectionToLoad);
            updateProgressBar(sectionToLoad);
        });
        
        function showContent(section, direction = 'none') {
            const content = document.getElementById('content');
            let animationClass = '';
            
            if (isMobile) {
                if (direction === 'down') {
                    animationClass = 'mobile-rotate-x-90';
                } else if (direction === 'up') {
                    animationClass = 'mobile-rotate-x-neg-90';
                } else if (direction === 'left') {
                    animationClass = 'mobile-rotate-y-neg-180';
                } else if (direction === 'right') {
                    animationClass = 'mobile-rotate-y-180';
                }
            } else {
                if (direction === 'down') {
                    animationClass = 'slide-down';
                } else if (direction === 'up') {
                    animationClass = 'slide-up';
                } else if (direction === 'left') {
                    animationClass = 'desktop-rotate-y-neg-90';
                } else if (direction === 'right') {
                    animationClass = 'desktop-rotate-y-90';
                }
            }
            
            content.style.opacity = '0';
            
            setTimeout(() => {
                fetch(`${CLOUD_FLARE_WORKER_URL}?section=${section}`)
                    .then(response => response.text())
                    .then(html => {
                        content.innerHTML = html;
                        content.style.transition = 'opacity 1s ease';
                        content.style.opacity = '1';
                        sessionStorage.setItem('lastSection', section);
                        if (animationClass) {
                            content.classList.add(animationClass);
                            setTimeout(() => {
                                content.classList.remove(animationClass);
                            }, 1000);
                        }
                    })
                    .catch(error => {
                        console.error("Error fetching content:", error);
                        content.innerHTML = `<p>Error loading content.</p>`;
                        content.style.opacity = '1';
                    });
            }, 500);
        }
        
        document.querySelectorAll('.menu-bar a').forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const section = event.target.getAttribute('data-section');
                showContent(section, 'none');
                updateProgressBar(section);
            });
        });
        
        const sectionOrder = ['home', 'about', 'projects', 'resume'];
        let currentSectionIndex = 0;
        let isThrottled = false;
        
        function updateProgressBar(section) {
            const progressBar = document.querySelector('.progress-bar div');
            const index = sectionOrder.indexOf(section);
            const progress = index / (sectionOrder.length - 1) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        function switchToNextSection(direction) {
            if (isThrottled) return;
            isThrottled = true;
            setTimeout(() => { isThrottled = false; }, 1000);
        
            if (direction === 'down' || direction === 'right') {
                currentSectionIndex = (currentSectionIndex + 1) % sectionOrder.length;
            } else if (direction === 'up' || direction === 'left') {
                currentSectionIndex = (currentSectionIndex - 1 + sectionOrder.length) % sectionOrder.length;
            }
        
            const nextSection = sectionOrder[currentSectionIndex];
            showContent(nextSection, direction);
            updateProgressBar(nextSection);
        }
        
            let trackpadScrolling = false;
            let trackpadTimer;
            
            window.addEventListener('wheel', event => {
              if (event.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {
                if (!trackpadScrolling) {
                  trackpadScrolling = true;
                  if (event.deltaY > 0) {
                    switchToNextSection('down');
                  } else if (event.deltaY < 0) {
                    switchToNextSection('up');
                  }
                }
                clearTimeout(trackpadTimer);
                trackpadTimer = setTimeout(() => {
                  trackpadScrolling = false;
                }, 200);
              } else {
                if (event.deltaY > 0) {
                  switchToNextSection('down');
                } else if (event.deltaY < 0) {
                  switchToNextSection('up');
                }
              }
            }, { passive: true });
        
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        
        window.addEventListener('touchstart', (event) => {
            touchStartX = event.changedTouches[0].screenX;
            touchStartY = event.changedTouches[0].screenY;
        });
        
        window.addEventListener('touchend', (event) => {
            touchEndX = event.changedTouches[0].screenX;
            touchEndY = event.changedTouches[0].screenY;
            handleGesture();
        });
        
        function handleGesture() {
            const deltaX = touchStartX - touchEndX;
            const deltaY = touchStartY - touchEndY;
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                if (isMobile) {
                    if (deltaX > 50) {
                        switchToNextSection('right');
                    } else if (deltaX < -50) {
                        switchToNextSection('left');
                    }
                } else {
                    if (deltaX > 50) {
                        switchToNextSection('left');
                    } else if (deltaX < -50) {
                        switchToNextSection('right');
                    }
                }
            } else {
                if (deltaY > 50) {
                    switchToNextSection('down');
                } else if (deltaY < -50) {
                    switchToNextSection('up');
                }
            }
        }
        
        addAnimationStyles();
        showContent('home', 'none');
        updateProgressBar('home');
    </script>
    
    <div id="music-popup">
        <div id="popup-content">
            <p>Would you like to enable music on this website?</p>
            <button id="enable-music">Yes</button>
            <button id="disable-music">No</button>
        </div>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
    var popup = document.getElementById('music-popup');
    var audio = new Audio('/assets/bg_music.mp3');
    audio.loop = true;
    var animationsTriggered = false;
    var container = document.querySelector('.container');
    var header = document.querySelector('header');
    var helpButton = document.querySelector('.help-button');
    var uButton = document.getElementById('unmuteButton');
    var mButton = document.getElementById('muteButton');
    var buttonhide = document.getElementById('buttonhide');
    var menubar = document.querySelector('.menu-bar');
    var modalOverlay = document.querySelector('.modal-overlay');
    var keydownEventListener;

    uButton.classList.add('hidden');
    mButton.classList.add('hidden');

    function autoCollapse() {
        buttonhide.style.display = 'none';
        menubar.style.marginRight = '-20px';
    }

    function expandHeader() {
        buttonhide.style.display = 'block';
        menubar.style.marginRight = '0px';
    }

    function isMobileDevice() {
        if (navigator.userAgentData) {
            return navigator.userAgentData.mobile;
        }
        
        const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i;
        return mobileRegex.test(navigator.userAgent);
    }

    if (!isMobileDevice()) {
    setTimeout(autoCollapse, 20000);
    header.addEventListener('mouseenter', expandHeader);
    header.addEventListener('mouseleave', autoCollapse);
    }

    function preloadAudio() {
        audio.preload = 'auto';
        audio.load();
    }

    function showPopup() {
        popup.style.display = 'flex';
        container.classList.add('disabled-container');
        header.classList.add('no-display');
        helpButton.classList.add('hidden');
        modalOverlay.classList.add('hidden');
        document.addEventListener('keydown', keydownEventListener);
    }

    function playMusic() {
        audio.play().then(() => {
            hidePopup();
            toggleMusicButtons();
        }).catch((error) => {
            console.error('Playback issue:', error);
            alert('Playback issue: Autoplay is not supported on this browser.');
            header.removeEventListener('mouseenter', expandHeader);
            autoCollapse();
            hidePopup();
        });
    }

    function hidePopup() {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        document.removeEventListener('keydown', keydownEventListener);
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
    }

    function toggleMusicButtons() {
        uButton.classList.toggle('hidden');
        mButton.classList.toggle('hidden');
    }

    unmuteButton.addEventListener('click', function() {
        playMusic();
    });

    muteButton.addEventListener('click', function() {
        audio.pause();
        toggleMusicButtons();
    });

    document.getElementById('enable-music').addEventListener('click', function() {
        playMusic();
    });

    document.getElementById('disable-music').addEventListener('click', function() {
        audio.pause();
        sessionStorage.setItem('musicPopupDisabled', 'true');
        hidePopup();
    });

    function startAnimations() {
        var menuBar = document.querySelector('.menu-bar');
        menuBar.classList.add('animate-menu-bar');

        var menuItems = document.querySelectorAll('.menu-bar ul li');
        menuItems.forEach(function(item, index) {
            setTimeout(function() {
                item.classList.add('animate-menu-item');
            }, index * 100);
        });
    }

    keydownEventListener = function(event) {
        if (event.key === 'Enter') {
            document.getElementById('enable-music').click();
        } else if (event.key === 'Backspace') {
            document.getElementById('disable-music').click();
        }
    };

    preloadAudio();

    const params = new URLSearchParams(window.location.search);
    const currentSection = params.get('section') || '';

    if (currentSection === 'links') {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
        return;
    }
    
    if (!sessionStorage.getItem('musicPopupDisabled')) {
        showPopup();
    } else {
        popup.style.display = 'none';
        container.classList.remove('disabled-container');
        header.classList.remove('no-display');
        helpButton.classList.remove('hidden');
        modalOverlay.classList.remove('hidden');
        uButton.classList.remove('hidden');
        if (!animationsTriggered) {
            startAnimations();
            animationsTriggered = true;
        }
    }
});   
</script>

    <div class="container" id="content">
        <h1 class="animated-text">Fusing Imagination with Innovation</h1>
        <p class="tagline">Explore Boundless Creativity.</p>
        <button id="home-button" class="center-button"><a href="/Links" target="_blank" style="text-decoration:none; color:black;">Discover Now</a></button>
    </div>
    
    <div id="preloader">
        <div id="blocks">
            <div class="block"></div>
            <div class="block"></div>
            <div class="block"></div>
            <div class="block"></div>
        </div>
    </div>

<div class="matrix-overlay" id="matrixOverlay">
    <div class="matrix-popup">
        <div class="matrix-header">
            <div class="status-indicator"></div>
            <span class="access-text">ACCESS GRANTED</span>
            <div class="close-btn" onclick="closePopup()">×</div>
        </div>
        
        <div class="matrix-content">
            <div class="matrix-rain" id="matrixRain"></div>
            
            <div class="content-wrapper">
                <div class="matrix-logo">
                    <span class="matrix-text">MATRIX</span>
                    <div class="underline"></div>
                </div>
                
                <div class="matrix-message">
                    <p>Digital realm access authorized</p>
                    <p class="sub-text">Ready to enter the simulation?</p>
                </div>
                
                <div class="button-group">
                    <button class="matrix-btn primary" onclick="enterMatrix()">
                        <span>ENTER</span>
                        <div class="btn-underline"></div>
                    </button>
                    <button class="matrix-btn secondary" onclick="closePopup()">
                        <span>CANCEL</span>
                    </button>
                </div>
            </div>
            
            <div class="countdown" id="countdown">10</div>
        </div>
    </div>
</div>

<script>
(function() {
    const SECRET_SEQUENCE = ['KeyM','KeyA','KeyT','KeyR','KeyI','KeyX'];
    let buffer = [];
    let countdownTimer;
    let countdownValue = 10;

    function createMatrixRain() {
        const rainContainer = document.getElementById('matrixRain');
        if (!rainContainer) return;
        
        const chars = ['0', '1', '|', '-', '/', '\\', '.', '*'];
        
        for (let i = 0; i < 15; i++) {
            setTimeout(() => {
                const char = document.createElement('div');
                char.className = 'rain-char';
                char.textContent = chars[Math.floor(Math.random() * chars.length)];
                char.style.left = Math.random() * 100 + '%';
                char.style.animationDelay = Math.random() * 2 + 's';
                char.style.animationDuration = (3 + Math.random() * 2) + 's';
                rainContainer.appendChild(char);
                
                setTimeout(() => {
                    if (char.parentNode) {
                        char.parentNode.removeChild(char);
                    }
                }, 4000);
            }, i * 150);
        }
    }

    function startCountdown() {
        const countdownEl = document.getElementById('countdown');
        if (!countdownEl) return;
        
        countdownTimer = setInterval(() => {
            countdownValue--;
            countdownEl.textContent = countdownValue;
            if (countdownValue <= 0) {
                enterMatrix();
            }
        }, 1000);
    }

    function showMatrixPopup() {
        const overlay = document.getElementById('matrixOverlay');
        if (!overlay) return;
        
        overlay.style.display = 'block';
        createMatrixRain();
        startCountdown();

        const rainInterval = setInterval(() => {
            if (overlay.style.display === 'block') {
                createMatrixRain();
            } else {
                clearInterval(rainInterval);
            }
        }, 2000);
    }

    window.closePopup = function() {
        const overlay = document.getElementById('matrixOverlay');
        if (overlay) overlay.style.display = 'none';
        if (countdownTimer) {
            clearInterval(countdownTimer);
            countdownValue = 10;
        }
    }

    window.enterMatrix = function() {
        window.location.href = '/Matrix';
        closePopup();
    }

    window.addEventListener('keydown', e => {
        buffer.push(e.code);
        
        if (buffer.length > SECRET_SEQUENCE.length) {
            buffer.shift();
        }
        
        if (
            buffer.length === SECRET_SEQUENCE.length &&
            SECRET_SEQUENCE.every((code, idx) => buffer[idx] === code)
        ) {
            showMatrixPopup();
            buffer = [];
        }
    });
})();

(function() {
    document.addEventListener('keydown', function(e) {
      const overlay = document.getElementById('matrixOverlay');
      if (!overlay) return;

      const style = window.getComputedStyle(overlay);
      if (style.display === 'none' || style.visibility === 'hidden' || overlay.classList.contains('hidden')) {
        return;
      }

      switch (e.key) {
        case 'Enter':
          e.preventDefault();
          enterMatrix();
          break;
        case 'Backspace':
          e.preventDefault();
          closePopup();
          break;
      }
    });
})();

document.addEventListener('DOMContentLoaded', function() {
    const popup = document.querySelector('.matrix-popup');
    const contentContainer = document.querySelector('.matrix-content');

    if (contentContainer) {
        contentContainer.style.perspective = '1500px';
    }

    let targetRotateX = 0, targetRotateY = 0, targetZ = 0;
    let currentRotateX = 0, currentRotateY = 0, currentZ = 0;
    let isHovering = false;
    const maxAngle = 20;
    const maxZ = 40;
    const lerpFactor = 0.12;

    function animate() {
        currentRotateX += (targetRotateX - currentRotateX) * lerpFactor;
        currentRotateY += (targetRotateY - currentRotateY) * lerpFactor;
        currentZ += (targetZ - currentZ) * lerpFactor;

        if (!isHovering && Math.abs(currentRotateX) < 0.5 && Math.abs(currentRotateY) < 0.5 && Math.abs(currentZ) < 0.5) {
            currentRotateX = 0;
            currentRotateY = 0;
            currentZ = 0;
            popup.style.transform = `translate(-50%, -50%) translateZ(0px) rotateX(0deg) rotateY(0deg)`;
            return;
        }

        popup.style.transform = 
            `translate(-50%, -50%) translateZ(${currentZ.toFixed(2)}px) ` +
            `rotateX(${currentRotateX.toFixed(2)}deg) rotateY(${currentRotateY.toFixed(2)}deg)`;

        requestAnimationFrame(animate);
    }

    function onMouseMove(e) {
        const rect = popup.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        const cx = rect.width / 2;
        const cy = rect.height / 2;
        const dx = (x - cx) / cx;
        const dy = (y - cy) / cy;

        targetRotateY = dx * maxAngle;
        targetRotateX = -dy * maxAngle;

        const normDist = Math.min(1, Math.sqrt(dx * dx + dy * dy) / Math.SQRT2);
        targetZ = (1 - 2 * normDist) * maxZ;
    }

    popup.addEventListener('mouseenter', function() {
        isHovering = true;
        popup.classList.add('hovered');
        if (Math.abs(currentRotateX) < 0.5 && Math.abs(currentRotateY) < 0.5 && Math.abs(currentZ) < 0.5) {
            animate();
        }
    });

    popup.addEventListener('mousemove', onMouseMove);

    popup.addEventListener('mouseleave', function() {
        isHovering = false;
        targetRotateX = 0;
        targetRotateY = 0;
        targetZ = 0;
        popup.classList.remove('hovered');
    });
});
</script>
    
    <footer>
        <p id="footer-text"></p>
    </footer>
    <canvas id="animationCanvas"></canvas>
    
    <style>
#loader {
    position: fixed;
    top: 30%;
    left: 50%;
    text-align: center;
    z-index: 1000;
}

#preloader {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    z-index: 1000;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    perspective: 1000px;
}

#blocks {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, 1fr);
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    will-change: transform, opacity;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
}

.block {
    position: relative;
    width: 100%;
    height: 100%;
    background: transparent;
    border: 2px solid #fff;
    transform: translateZ(50px) scale(1);
    opacity: 1;
    animation: cosmicShift 4s ease-in-out infinite forwards;
}

.block::before {
    content: "";
    position: absolute;
    top: -5%;
    left: -5%;
    width: 110%;
    height: 110%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    filter: blur(8px);
    z-index: -1;
    opacity: 0.7;
}

.block:nth-child(1) {
    animation-delay: 0s;
}

.block:nth-child(2) {
    animation-delay: 0.3s;
}

.block:nth-child(3) {
    animation-delay: 0.6s;
}

.block:nth-child(4) {
    animation-delay: 0.9s;
}

@keyframes cosmicShift {
    0% {
        transform: rotate3d(0, 1, 0, 0deg) scale(1) translateZ(50px);
        opacity: 1;
    }
    20% {
        transform: rotate3d(1, 1, 0, 90deg) scale(1.1) translateZ(60px);
        opacity: 0.9;
    }
    40% {
        transform: rotate3d(1, 0, 1, 180deg) scale(0.9) translateZ(40px);
        opacity: 0.8;
    }
    60% {
        transform: rotate3d(0, 1, 1, 270deg) scale(1.2) translateZ(20px);
        opacity: 0.7;
    }
    80% {
        transform: rotate3d(1, 1, 1, 360deg) scale(0.8) translateZ(30px);
        opacity: 0.5;
    }
    100% {
        transform: rotate3d(0, 1, 0, 450deg) scale(0) translateZ(50px);
        opacity: 0;
    }
}

@media screen and (max-width: 768px) {
    #blocks {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
    }
    .block {
        border-width: 1px;
    }
}

@media screen and (max-width: 480px) {
    #blocks {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr;
    }
    .block {
        width: 100vw;
        height: 100vh;
        border-width: 1px;
    }
}
    </style>
    
    <script>
  document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const currentSection = params.get('section') || '';

      if (currentSection === 'links') {
          const existingPreloader = document.getElementById('preloader');
          if (existingPreloader) {
              existingPreloader.style.display = 'none';
          }
          return;
      }

      const loader = document.getElementById('loader');
      if (loader) {
          loader.id = 'preloader';
      }

      const preloader = document.getElementById('preloader');
      const blocks = document.querySelectorAll('.block');

      if (preloader) {
          preloader.style.display = 'flex';
      }

      setTimeout(() => {
          blocks.forEach(block => {
              block.style.willChange = 'transform, opacity';
          });
      }, 100);

      setTimeout(() => {
          document.body.classList.add('loaded');
          if (preloader) {
              preloader.style.display = 'none';
          }
      }, 4000);
  });
</script>

    <script>
    function isWebGLAvailable() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                return !!(gl && gl instanceof WebGLRenderingContext);
            } catch (e) {
                return false;
            }
        }

    function fallbackToCanvasAnimation() {

    document.body.style.cursor = 'crosshair';

    /* Dynamic star color for light/dark theme */
    let starR = 255, starG = 255, starB = 255;
    window.addEventListener('themeChanged', (e) => {
        if (e.detail && e.detail.light) {
            starR = 30; starG = 30; starB = 30;
        } else {
            starR = 255; starG = 255; starB = 255;
        }
    });
    
    const canvas = document.getElementById('animationCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    const stars = [];
    const minStars = 250;
    const maxStars = 500;
    const edgeThreshold = 10;

    function createStar() {
        const speed = Math.random() * 0.5 + 0.1;
        return {
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 3,
            speed: speed,
            alpha: Math.random(),
            phase: Math.random() * 2 * Math.PI,
            dx: (Math.random() - 0.5) * speed,
            dy: (Math.random() - 0.5) * speed,
            tiltFactor: Math.random() * 0.05 + 0.05,
            trail: []
        };
    }

    function removeOffScreenStars() {
        for (let i = stars.length - 1; i >= 0; i--) {
            const star = stars[i];
            if (star.x < -edgeThreshold || star.x > canvas.width + edgeThreshold ||
                star.y < -edgeThreshold || star.y > canvas.height + edgeThreshold) {
                stars.splice(i, 1);
            }
        }
    }

    for (let i = 0; i < minStars; i++) {
        stars.push(createStar());
    }

    let mouseX = canvas.width / 2;
    let mouseY = canvas.height / 2;
    const avoidanceRadius = 100;
    let lastMouseMoveTime = Date.now();
    const mouseInactiveThreshold = 3000;

    canvas.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        lastMouseMoveTime = Date.now();
    });

    let tiltX = 0;

    window.addEventListener('deviceorientation', (e) => {
        tiltX = e.gamma;
    });

    function deflectStar(star1, star2) {
        const angle = Math.random() * 2 * Math.PI;
        const speed = Math.random() * 0.5 + 0.1;
        star1.dx = Math.cos(angle) * speed;
        star1.dy = Math.sin(angle) * speed;
        star2.dx = -Math.cos(angle) * speed;
        star2.dy = -Math.sin(angle) * speed;
    }

    function applyAI(star) {
        const now = Date.now();
        const mouseInactive = now - lastMouseMoveTime > mouseInactiveThreshold;

        if (!mouseInactive) {
            const dx = star.x - mouseX;
            const dy = star.y - mouseY;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance < avoidanceRadius) {
                const angle = Math.atan2(dy, dx) + (Math.random() - 0.5) * Math.PI;
                const speedFactor = (avoidanceRadius - distance) / avoidanceRadius;
                star.dx = Math.cos(angle) * speedFactor * star.speed;
                star.dy = Math.sin(angle) * speedFactor * star.speed;
            } else {
                star.dx += (Math.random() - 0.5) * 0.1;
                star.dy += (Math.random() - 0.5) * 0.1;
            }
        } else {
            star.dx += (Math.random() - 0.5) * 0.1;
            star.dy += (Math.random() - 0.5) * 0.1;
        }

        star.x += star.dx;
        star.y += star.dy;

        star.x += tiltX * star.tiltFactor;

        if (star.x < edgeThreshold) star.dx += (edgeThreshold - star.x) / edgeThreshold * 0.05;
        if (star.x > canvas.width - edgeThreshold) star.dx -= (star.x - (canvas.width - edgeThreshold)) / edgeThreshold * 0.05;
        if (star.y < edgeThreshold) star.dy += (edgeThreshold - star.y) / edgeThreshold * 0.05;
        if (star.y > canvas.height - edgeThreshold) star.dy -= (star.y - (canvas.height - edgeThreshold)) / edgeThreshold * 0.05;

        if (star.x < 0) star.x = 0;
        if (star.x > canvas.width) star.x = canvas.width;
        if (star.y < 0) star.y = 0;
        if (star.y > canvas.height) star.y = canvas.height;

        star.alpha = 0.5 + Math.cos(star.phase) * 0.5;
        star.phase += star.speed * 0.05;

        if (star.trail.length > 10) star.trail.shift();
        star.trail.push({ x: star.x, y: star.y, alpha: star.alpha });
    }

    function handleCollisions() {
        for (let i = 0; i < stars.length; i++) {
            for (let j = i + 1; j < stars.length; j++) {
                const star1 = stars[i];
                const star2 = stars[j];
                const dx = star1.x - star2.x;
                const dy = star1.y - star2.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < (star1.radius + star2.radius)) {
                    deflectStar(star1, star2);
                }
            }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        while (stars.length < minStars) {
            stars.push(createStar());
        }

        while (stars.length > maxStars) {
            stars.pop();
        }

        stars.forEach(star => {
            applyAI(star);

            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2, false);
            ctx.fillStyle = `rgba(${starR}, ${starG}, ${starB}, ${star.alpha})`;
            ctx.fill();

            for (let j = 0; j < star.trail.length; j++) {
                const t = star.trail[j];
                const trailAlpha = t.alpha * (1 - j / star.trail.length);
                const trailRadius = star.radius * (1 - j / star.trail.length);
                ctx.beginPath();
                ctx.arc(t.x, t.y, trailRadius, 0, Math.PI * 2, false);
                ctx.fillStyle = `rgba(${starR}, ${starG}, ${starB}, ${trailAlpha})`;
                ctx.fill();
            }
        });

        handleCollisions();
        removeOffScreenStars();
        requestAnimationFrame(draw);
    }

    draw();
}

function isOldBrowser() {
    const userAgent = navigator.userAgent;

    const oldBrowserRegex = /MSIE|Trident|Edge\/\d{1,2}\./; 
            const oldSafariRegex = /Version\/[1-9]\.\d Safari\//; 
            const oldFirefoxRegex = /Firefox\/[1-9][0-9]?\./; 
            const oldChromeRegex = /Chrome\/[1-5]\d\./;
            const oldOperaRegex = /Opera\/[1-9]\d\./;
            const oldAndroidRegex = /Android [1-4]\./;
            const oldiOSRegex = /CPU iPhone OS [1-9]_/;

    return oldBrowserRegex.test(userAgent) || oldSafariRegex.test(userAgent);
}

document.body.style.cursor = 'none';

    if (!isWebGLAvailable() || isOldBrowser()) {
        console.log("WebGL is not supported or the browser is outdated. Switching to fallback animation.");
        document.querySelectorAll(".cursor-dot, .cursor-dot-outline").forEach(element => {
            element.remove();
        });
         fallbackToCanvasAnimation();
    }
    </script>
    
    <script type="module" src="script.js"></script>

<!-- Sunrise flash overlay for light theme transition -->
<div id="sunrise-overlay"></div>

<!-- SURYA Easter Egg: type S-U-R-Y-A to toggle light theme -->
<script>
(function() {
    const LIGHT_SEQUENCE = ['KeyS','KeyU','KeyR','KeyY','KeyA'];
    let lightBuffer = [];

    function toggleLightTheme() {
        const isLight = document.body.classList.toggle('light-theme');
        const overlay = document.getElementById('sunrise-overlay');

        /* Add transition class for smooth color animation */
        document.body.classList.add('theme-transitioning');

        /* Fire sunrise flash */
        if (overlay) {
            overlay.classList.add('active');
            setTimeout(() => overlay.classList.remove('active'), 800);
        }

        /* Remove transition class after animation completes */
        setTimeout(() => {
            document.body.classList.remove('theme-transitioning');
        }, 600);

        /* Dispatch custom event for canvas/Three.js listeners */
        window.dispatchEvent(new CustomEvent('themeChanged', {
            detail: { light: isLight }
        }));
    }

    window.addEventListener('keydown', (e) => {
        /* Don't capture when modifiers are held (avoid conflict with shortcuts) */
        if (e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) return;

        lightBuffer.push(e.code);

        if (lightBuffer.length > LIGHT_SEQUENCE.length) {
            lightBuffer.shift();
        }

        if (
            lightBuffer.length === LIGHT_SEQUENCE.length &&
            LIGHT_SEQUENCE.every((code, idx) => lightBuffer[idx] === code)
        ) {
            toggleLightTheme();
            lightBuffer = [];
        }
    });
})();
</script>

</body>
</html>
